{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5556432f",
   "metadata": {},
   "source": [
    "# Tutorial 52: General Creation of Element Dataframes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8899e69a",
   "metadata": {},
   "source": [
    "This Example demonstrates the capabilities of the class Dataframes_SIR3S_Model that extends SIR3S_Model be abilities to work directley with pandas dataframes. It is shown how to create dataframes containing information about elements such as Nodes, Pipes, etc. existing in a SIR 3S Model. The methods presented are not user-defined and neither efficient, but get you the most important information quickly. For more detailed methods of creating dataframes, see Tutorial 51."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2d40c36",
   "metadata": {},
   "source": [
    "# Toolkit Release"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7fb5a07b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#pip install "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d6773e12",
   "metadata": {},
   "source": [
    "# Imports"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "134689cf",
   "metadata": {},
   "source": [
    "## SIR 3S Toolkit"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69665f68",
   "metadata": {},
   "source": [
    "### Regular Import/Init"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "79d0fb2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "SIR3S_SIRGRAF_DIR = r\"C:\\3S\\SIR 3S\\SirGraf-90-15-00-20x64_Quebec-Upd1\" #change to local path"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0f41d17a",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sir3stoolkit.core import wrapper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d539c981",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<module 'sir3stoolkit.core.wrapper' from 'C:\\\\Users\\\\aUsername\\\\3S\\\\sir3stoolkit\\\\src\\\\sir3stoolkit\\\\core\\\\wrapper.py'>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wrapper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "37d59df0",
   "metadata": {},
   "outputs": [],
   "source": [
    "wrapper.Initialize_Toolkit(SIR3S_SIRGRAF_DIR)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ebf2c56e",
   "metadata": {},
   "source": [
    "### Additional Import/Init for Dataframes class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "893f889e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sir3stoolkit.mantle.dataframes import SIR3S_Model_Dataframes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4b65297f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Initialization complete\n"
     ]
    }
   ],
   "source": [
    "s3s = SIR3S_Model_Dataframes()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2007993a",
   "metadata": {},
   "source": [
    "## Additional"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3a443734",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from shapely.geometry import Point\n",
    "import re\n",
    "import folium\n",
    "from folium.plugins import HeatMap\n",
    "import numpy as np\n",
    "import geopandas as gpd\n",
    "from shapely import wkt\n",
    "import matplotlib.pyplot as plt\n",
    "import contextily as cx"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d9a78e4d",
   "metadata": {},
   "source": [
    "# Open Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "20ff3c21",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model is open for further operation\n"
     ]
    }
   ],
   "source": [
    "s3s.OpenModel(dbName=r\"C:\\Users\\aUsername\\3S\\PT3S\\PT3S\\Examples\\Example3.db3\",\n              providerType=s3s.ProviderTypes.SQLite,\n              Mid=\"M-1-0-1\",\n              saveCurrentlyOpenModel=False,\n              namedInstance=\"\",\n              userID=\"\",\n              password=\"\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ccc8f89c",
   "metadata": {},
   "source": [
    "# Generate Element Dataframes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d6189f7",
   "metadata": {},
   "source": [
    "We can use the [generate_element_dataframe()](https://3sconsult.github.io/sir3stoolkit/references/sir3stoolkit.mantle.html#sir3stoolkit.mantle.dataframes.SIR3S_Model_Dataframes.generate_element_dataframe) method to quickly generate basic dataframes containing all instances of hydraulic element types (Node, Pipe, etc.) in a SIR 3S model. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e94e2f37",
   "metadata": {},
   "source": [
    "All metadata and most result values (self.GetResultProperties_from_elementType(onlySelectedVectors=True)) for the static timestamp are included. Result values are given as floats, unless they are in vectorized form (relevant only for pipes), in that case they are strings."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bfe6454d",
   "metadata": {},
   "source": [
    "The pd.Dataframe will automatically be transformed into a gpd.GeoDataFrame if a SRID is defined in the model, after a geometry column is created."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "16e105ab",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['AGSN_HydraulicProfile', 'AirVessel', 'Arrow', 'Atmosphere', 'BlockConnectionNode', 'CalcPari', 'CharacteristicLossTable', 'CharacteristicLossTable_Row', 'Circle', 'Compressor', 'CompressorTable', 'CompressorTable_Row', 'ControlEngineeringNexus', 'ControlMode', 'ControlPointTable', 'ControlPointTable_Row', 'ControlValve', 'ControlVariableConverter', 'ControlVariableConverterRSTE', 'CrossSectionTable', 'CrossSectionTable_Row', 'DPGR_DPKT_DatapointDpgrConnection', 'DPGR_DataPointGroup', 'DPKT_Datapoint', 'DamageRatesTable', 'DamageRatesTable_Row', 'DeadTimeElement', 'Demand', 'DifferentialRegulator', 'DirectionalArrow', 'DistrictHeatingConsumer', 'DistrictHeatingFeeder', 'Divider', 'DriveEfficiencyTable', 'DriveEfficiencyTable_Row', 'DrivePowerTable', 'DrivePowerTable_Row', 'EBES_FeederGroups', 'EfficiencyConverterTable', 'EfficiencyConverterTable_Row', 'ElementQuery', 'EnergyRecoveryTable', 'EnergyRecoveryTable_Row', 'EnvironmentTemp', 'FWBZ_DistrictHeatingReferenceValues', 'FlapValve', 'FlowControlUnit', 'FluidQualityParamSet', 'FluidQualityParamSet_OS', 'FluidThermalPropertyGroup', 'FreeDuct', 'FunctionGenerator', 'FunctionTable', 'FunctionTable_Row', 'GasComponent', 'GasMixture', 'GeneralSection', 'Gravitation', 'HeatExchanger', 'HeatFeederConsumerStation', 'HeaterCooler', 'Histeresis', 'House', 'Hydrant', 'Integrator', 'LAYR_Layer', 'LoadFactorTable', 'LoadFactorTable_Row', 'LogicalComparison', 'LogicalStorage', 'MeasuredVariableTable', 'MeasuredVariableTable_Row', 'MinMaxSelection', 'Multiplier', 'NetValve', 'Node', 'NonReturnValvesTable', 'NonReturnValvesTable_Row', 'NumericalDisplay', 'ObjectContainerSymbol', 'OpenContainer', 'Oval', 'PARZ_TransientCalculationParameters', 'PhaseSeparation', 'PidController', 'Pipe', 'PipeGroup', 'PipeTable', 'PipeTable_Row', 'PipeVertex', 'Polygon', 'Polyline', 'PressureRegulator', 'PressureZone', 'Pt1Controller', 'Pump', 'PumpCharTable', 'PumpCharTable_Row', 'PumpGroup', 'PumpOfPumpGroup', 'PumpSpeedTable', 'PumpSpeedTable_Row', 'RART_ControlMode', 'REGP_ControlParameters', 'RMES_DPTS_RmesInternalDataPoint', 'Rectangle', 'RegulatorsTable', 'RegulatorsTable_Row', 'ReturnTemperaturTable', 'ReturnTemperaturTable_Row', 'RoundRectangle', 'SIRGRAF', 'SPLZ_TimeSeries', 'SafetyValve', 'SetpointDevice', 'SolarCollector', 'StandPipe', 'Street', 'SummingPoint', 'SwitchInBlock', 'TemperatureTable', 'TemperatureTable_Row', 'Text', 'ThermalOutputTable', 'ThermalOutputTable_Row', 'ThermophysPropTable', 'ThermophysPropTable_Row', 'TransitionSymbol', 'Transmitter', 'TransportVariable', 'USCH_UserDefinedProperties', 'Unknown', 'VARA_ColorScale', 'VARA_ROWS_WidthOrScale', 'VRCT_ViewRectangle', 'Valve', 'ValveLiftTable', 'ValveLiftTable_Row', 'VarFlowTable', 'VarFlowTable_Row', 'VarPressureTable', 'VarPressureTable_Row', 'VentOpenCloseTable', 'VentOpenCloseTable_Row', 'VentValve', 'VentilatedPressureAirVessel', 'WBLZ_ThermalBalance', 'WeatherDataTable', 'WeatherDataTable_Row']\n"
     ]
    }
   ],
   "source": [
    "object_types = [item for item in dir(s3s.ObjectTypes) if not (item.startswith('__') and item.endswith('__'))]\n",
    "print(object_types) # Check for hydraulic elmement types"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb750618",
   "metadata": {},
   "source": [
    "This function allows for little user definition the only paramters are element_type and tks of that element type to exclusively use. For more user defined dataframe creation see Tutorial 52."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8446b05",
   "metadata": {},
   "source": [
    "## Node"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "1929d1bb",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[2025-12-19 15:53:22,951] INFO in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df for element type: ObjectTypes.Node ...\n",
      "[2025-12-19 15:53:22,951] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_metadata for element type: ObjectTypes.Node ...\n",
      "[2025-12-19 15:53:22,952] INFO in sir3stoolkit.mantle.dataframes: [metadata] Generating metadata dataframe for element type: ObjectTypes.Node\n",
      "[2025-12-19 15:53:22,960] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieved 517 element(s) of element type ObjectTypes.Node.\n",
      "[2025-12-19 15:53:22,969] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] No properties given → using ALL metadata properties for ObjectTypes.Node.\n",
      "[2025-12-19 15:53:22,969] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] Using 37 metadata properties.\n",
      "[2025-12-19 15:53:22,969] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieving metadata properties ['Name', 'Ktyp', 'Zkor', 'QmEin', 'Lfakt', 'Fkpzon', 'Fkfstf', 'Fkutmp', 'Fkfqps', 'Fkcont', 'Fk2lknot', 'Beschreibung', 'Idreferenz', 'Iplanung', 'Kvr', 'Qakt', 'Xkor', 'Ykor', 'NodeNamePosition', 'ShowNodeName', 'KvrKlartext', 'NumberOfVERB', 'HasBlockConnection', 'Tk', 'Pk', 'InVariant', 'GeometriesDiffer', 'SymbolFactor', 'bz.Drakonz', 'bz.Fk', 'bz.Fkpvar', 'bz.Fkqvar', 'bz.Fklfkt', 'bz.PhEin', 'bz.Tm', 'bz.Te', 'bz.PhMin'], geometry, end nodes...\n",
      "[2025-12-19 15:53:23,051] WARNING in sir3stoolkit.mantle.dataframes: [metadata] End nodes are not defined for element type ObjectTypes.Node. Dataframe is created without end nodes.\n",
      "[2025-12-19 15:53:24,118] INFO in sir3stoolkit.mantle.dataframes: [metadata] Transforming DataFrame to GeoDataFrame successful with EPSG: 25832\n",
      "[2025-12-19 15:53:24,118] INFO in sir3stoolkit.mantle.dataframes: [metadata] Done. Shape: (517, 39)\n",
      "[2025-12-19 15:53:24,127] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_results for element type: ObjectTypes.Node ...\n",
      "[2025-12-19 15:53:24,196] INFO in sir3stoolkit.mantle.dataframes: [results] Generating results dataframe for element type: ObjectTypes.Node\n",
      "[2025-12-19 15:53:24,267] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] Only static timestamp 2023-02-13 00:00:00.000 +01:00 is used\n",
      "[2025-12-19 15:53:24,269] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] 1 valid timestamp(s) will be used.\n",
      "[2025-12-19 15:53:24,272] INFO in sir3stoolkit.mantle.dataframes: [Resolving tks] Retrieved 517 element(s) of element type ObjectTypes.Node.\n",
      "[2025-12-19 15:53:24,274] INFO in sir3stoolkit.mantle.dataframes: [results] Using 21 result properties.\n",
      "[2025-12-19 15:53:24,282] INFO in sir3stoolkit.mantle.dataframes: [results] Retrieving result values...\n",
      "[2025-12-19 15:53:25,867] INFO in sir3stoolkit.mantle.dataframes: [results] Done. Shape: (1, 10857)\n",
      "[2025-12-19 15:53:25,867] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Merging df_metadata with df_results for element type: ObjectTypes.Node ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tk</th>\n",
       "      <th>Name</th>\n",
       "      <th>Ktyp</th>\n",
       "      <th>Zkor</th>\n",
       "      <th>QmEin</th>\n",
       "      <th>Lfakt</th>\n",
       "      <th>Fkpzon</th>\n",
       "      <th>Fkfstf</th>\n",
       "      <th>Fkutmp</th>\n",
       "      <th>Fkfqps</th>\n",
       "      <th>Fkcont</th>\n",
       "      <th>Fk2lknot</th>\n",
       "      <th>Beschreibung</th>\n",
       "      <th>Idreferenz</th>\n",
       "      <th>Iplanung</th>\n",
       "      <th>Kvr</th>\n",
       "      <th>Qakt</th>\n",
       "      <th>Xkor</th>\n",
       "      <th>Ykor</th>\n",
       "      <th>NodeNamePosition</th>\n",
       "      <th>ShowNodeName</th>\n",
       "      <th>KvrKlartext</th>\n",
       "      <th>NumberOfVERB</th>\n",
       "      <th>HasBlockConnection</th>\n",
       "      <th>Tk</th>\n",
       "      <th>Pk</th>\n",
       "      <th>InVariant</th>\n",
       "      <th>GeometriesDiffer</th>\n",
       "      <th>SymbolFactor</th>\n",
       "      <th>bz.Drakonz</th>\n",
       "      <th>bz.Fk</th>\n",
       "      <th>bz.Fkpvar</th>\n",
       "      <th>bz.Fkqvar</th>\n",
       "      <th>bz.Fklfkt</th>\n",
       "      <th>bz.PhEin</th>\n",
       "      <th>bz.Tm</th>\n",
       "      <th>bz.Te</th>\n",
       "      <th>bz.PhMin</th>\n",
       "      <th>geometry</th>\n",
       "      <th>BCIND</th>\n",
       "      <th>DP</th>\n",
       "      <th>DPH</th>\n",
       "      <th>H</th>\n",
       "      <th>HMAX_INST</th>\n",
       "      <th>HMIN_INST</th>\n",
       "      <th>IAKTIV</th>\n",
       "      <th>LFAKTAKT</th>\n",
       "      <th>P</th>\n",
       "      <th>PDAMPF</th>\n",
       "      <th>PH</th>\n",
       "      <th>PHMINMAXDIF</th>\n",
       "      <th>PH_EIN</th>\n",
       "      <th>PH_MIN</th>\n",
       "      <th>PMAX_INST</th>\n",
       "      <th>PMIN_INST</th>\n",
       "      <th>QM</th>\n",
       "      <th>RHO</th>\n",
       "      <th>T</th>\n",
       "      <th>TTR</th>\n",
       "      <th>VOLD</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4612618373909997110</td>\n",
       "      <td>V-K2133S</td>\n",
       "      <td>QKON</td>\n",
       "      <td>543,56</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5520728169779652386</td>\n",
       "      <td>4798673252636751115</td>\n",
       "      <td>5591325053703727727</td>\n",
       "      <td>-1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>5611267768413515094</td>\n",
       "      <td>Anfangsknoten generiert von SirDB</td>\n",
       "      <td>3S96AE619D388EA6F4CC9F24456148E088</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>714332,858073876</td>\n",
       "      <td>5578924,32804792</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>Vorlauf</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>4612618373909997110</td>\n",
       "      <td>4612618373909997110</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0</td>\n",
       "      <td>4612618373909997110</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>POINT (714332.858 5578924.328)</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.007826</td>\n",
       "      <td>0.007826</td>\n",
       "      <td>1.121131</td>\n",
       "      <td>1.121131</td>\n",
       "      <td>1.121131</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.772014</td>\n",
       "      <td>0.012300</td>\n",
       "      <td>0.772014</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.772014</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.772014</td>\n",
       "      <td>1.772014</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.3000</td>\n",
       "      <td>10.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4619205996903908050</td>\n",
       "      <td>V-K983S</td>\n",
       "      <td>QKON</td>\n",
       "      <td>548,26</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5520728169779652386</td>\n",
       "      <td>4798673252636751115</td>\n",
       "      <td>5591325053703727727</td>\n",
       "      <td>-1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>5130743098019975840</td>\n",
       "      <td>Anfangsknoten generiert von SirDB</td>\n",
       "      <td>3S56C0B9A1652EF8E9B7AB8C5DEACA2DC4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>713611,070733335</td>\n",
       "      <td>5578598,06739649</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>Vorlauf</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>4619205996903908050</td>\n",
       "      <td>4619205996903908050</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0</td>\n",
       "      <td>4619205996903908050</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>POINT (713611.071 5578598.067)</td>\n",
       "      <td>17.0</td>\n",
       "      <td>1.650540</td>\n",
       "      <td>1.650540</td>\n",
       "      <td>4.942585</td>\n",
       "      <td>4.942585</td>\n",
       "      <td>4.942585</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.132555</td>\n",
       "      <td>0.695561</td>\n",
       "      <td>4.132555</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.132555</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.132555</td>\n",
       "      <td>5.132555</td>\n",
       "      <td>0.0</td>\n",
       "      <td>965.8268</td>\n",
       "      <td>89.78860</td>\n",
       "      <td>0.213703</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4619682681341516951</td>\n",
       "      <td>R-K2803S</td>\n",
       "      <td>QKON</td>\n",
       "      <td>554,99</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5520728169779652386</td>\n",
       "      <td>4798673252636751115</td>\n",
       "      <td>5591325053703727727</td>\n",
       "      <td>-1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>5367059433340055050</td>\n",
       "      <td>Anfangsknoten generiert von SirDB</td>\n",
       "      <td>3S7BD49C919428AD75D6EA1203195E860E</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>713542,639480857</td>\n",
       "      <td>5578804,84152978</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>Rücklauf</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>4619682681341516951</td>\n",
       "      <td>4619682681341516951</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0</td>\n",
       "      <td>4619682681341516951</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>POINT (713542.639 5578804.842)</td>\n",
       "      <td>17.0</td>\n",
       "      <td>1.542220</td>\n",
       "      <td>1.542220</td>\n",
       "      <td>3.360220</td>\n",
       "      <td>3.360220</td>\n",
       "      <td>3.360220</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.890204</td>\n",
       "      <td>0.197127</td>\n",
       "      <td>1.890204</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.890204</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.890204</td>\n",
       "      <td>2.890204</td>\n",
       "      <td>0.0</td>\n",
       "      <td>983.8152</td>\n",
       "      <td>59.76965</td>\n",
       "      <td>0.168082</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    tk      Name  Ktyp    Zkor QmEin Lfakt  \\\n",
       "0  4612618373909997110  V-K2133S  QKON  543,56     0     1   \n",
       "1  4619205996903908050   V-K983S  QKON  548,26     0     1   \n",
       "2  4619682681341516951  R-K2803S  QKON  554,99     0     1   \n",
       "\n",
       "                Fkpzon               Fkfstf               Fkutmp Fkfqps  \\\n",
       "0  5520728169779652386  4798673252636751115  5591325053703727727     -1   \n",
       "1  5520728169779652386  4798673252636751115  5591325053703727727     -1   \n",
       "2  5520728169779652386  4798673252636751115  5591325053703727727     -1   \n",
       "\n",
       "                Fkcont             Fk2lknot  \\\n",
       "0  5029128874972463118  5611267768413515094   \n",
       "1  5029128874972463118  5130743098019975840   \n",
       "2  5029128874972463118  5367059433340055050   \n",
       "\n",
       "                        Beschreibung                          Idreferenz  \\\n",
       "0  Anfangsknoten generiert von SirDB  3S96AE619D388EA6F4CC9F24456148E088   \n",
       "1  Anfangsknoten generiert von SirDB  3S56C0B9A1652EF8E9B7AB8C5DEACA2DC4   \n",
       "2  Anfangsknoten generiert von SirDB  3S7BD49C919428AD75D6EA1203195E860E   \n",
       "\n",
       "  Iplanung Kvr Qakt              Xkor              Ykor NodeNamePosition  \\\n",
       "0        1   1    0  714332,858073876  5578924,32804792                1   \n",
       "1        1   1    0  713611,070733335  5578598,06739649                1   \n",
       "2        1   2    0  713542,639480857  5578804,84152978                1   \n",
       "\n",
       "  ShowNodeName KvrKlartext NumberOfVERB HasBlockConnection  \\\n",
       "0        False     Vorlauf            0              False   \n",
       "1        False     Vorlauf            0              False   \n",
       "2        False    Rücklauf            0              False   \n",
       "\n",
       "                    Tk                   Pk InVariant GeometriesDiffer  \\\n",
       "0  4612618373909997110  4612618373909997110     False            False   \n",
       "1  4619205996903908050  4619205996903908050     False            False   \n",
       "2  4619682681341516951  4619682681341516951     False            False   \n",
       "\n",
       "  SymbolFactor bz.Drakonz                bz.Fk bz.Fkpvar bz.Fkqvar bz.Fklfkt  \\\n",
       "0          0,2          0  4612618373909997110        -1        -1        -1   \n",
       "1          0,2          0  4619205996903908050        -1        -1        -1   \n",
       "2          0,2          0  4619682681341516951        -1        -1        -1   \n",
       "\n",
       "  bz.PhEin bz.Tm bz.Te bz.PhMin                        geometry  BCIND  \\\n",
       "0        0     0     0        0  POINT (714332.858 5578924.328)   17.0   \n",
       "1        0     0     0        0  POINT (713611.071 5578598.067)   17.0   \n",
       "2        0     0     0        0  POINT (713542.639 5578804.842)   17.0   \n",
       "\n",
       "         DP       DPH         H  HMAX_INST  HMIN_INST  IAKTIV  LFAKTAKT  \\\n",
       "0  0.007826  0.007826  1.121131   1.121131   1.121131     1.0       1.0   \n",
       "1  1.650540  1.650540  4.942585   4.942585   4.942585     0.0       1.0   \n",
       "2  1.542220  1.542220  3.360220   3.360220   3.360220     0.0       1.0   \n",
       "\n",
       "          P    PDAMPF        PH  PHMINMAXDIF    PH_EIN  PH_MIN  PMAX_INST  \\\n",
       "0  1.772014  0.012300  0.772014          0.0  0.772014     0.0   1.772014   \n",
       "1  5.132555  0.695561  4.132555          0.0  4.132555     0.0   5.132555   \n",
       "2  2.890204  0.197127  1.890204          0.0  1.890204     0.0   2.890204   \n",
       "\n",
       "   PMIN_INST   QM        RHO         T       TTR  VOLD  \n",
       "0   1.772014  0.0  1000.3000  10.00000  0.000000   0.0  \n",
       "1   5.132555  0.0   965.8268  89.78860  0.213703   0.0  \n",
       "2   2.890204  0.0   983.8152  59.76965  0.168082   0.0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(s3s.generate_element_dataframe(element_type=s3s.ObjectTypes.Node, tks=None)).head(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "42c338bc",
   "metadata": {},
   "source": [
    "## Pipe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "7ac84f6c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df for element type: ObjectTypes.Pipe ...\n",
      "[2025-12-19 15:53:25,951] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_metadata for element type: ObjectTypes.Pipe ...\n",
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [metadata] Generating metadata dataframe for element type: ObjectTypes.Pipe\n",
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieved 524 element(s) of element type ObjectTypes.Pipe.\n",
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] No properties given → using ALL metadata properties for ObjectTypes.Pipe.\n",
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] Using 46 metadata properties.\n",
      "[2025-12-19 15:53:25,951] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieving metadata properties ['Name', 'FkdtroRowd', 'Fkltgr', 'Fkstrasse', 'L', 'Lzu', 'Rau', 'Jlambs', 'Lambda0', 'Zein', 'Zaus', 'Zuml', 'Asoll', 'Indschall', 'Baujahr', 'Hal', 'Fkcont', 'Fk2lrohr', 'Beschreibung', 'Idreferenz', 'Iplanung', 'Kvr', 'LineWidthMM', 'DottedLine', 'DN', 'Di', 'KvrKlartext', 'HasClosedNSCHs', 'Tk', 'Pk', 'InVariant', 'Xkor', 'Ykor', 'GeometriesDiffer', 'bz.Fk', 'bz.Qsvb', 'bz.Irtrenn', 'bz.Leckstatus', 'bz.Leckstart', 'bz.Leckend', 'bz.Leckort', 'bz.Leckmenge', 'bz.Imptnz', 'bz.Zvlimptnz', 'bz.Kantenzv', 'bz.ITrennWithNSCH'], geometry, end nodes...\n",
      "[2025-12-19 15:53:27,384] INFO in sir3stoolkit.mantle.dataframes: [metadata] 2 non-empty end node columns were created.\n",
      "[2025-12-19 15:53:27,401] INFO in sir3stoolkit.mantle.dataframes: [metadata] Transforming DataFrame to GeoDataFrame successful with EPSG: 25832\n",
      "[2025-12-19 15:53:27,408] INFO in sir3stoolkit.mantle.dataframes: [metadata] Done. Shape: (524, 50)\n",
      "[2025-12-19 15:53:27,409] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_results for element type: ObjectTypes.Pipe ...\n",
      "[2025-12-19 15:53:27,618] INFO in sir3stoolkit.mantle.dataframes: [results] Generating results dataframe for element type: ObjectTypes.Pipe\n",
      "[2025-12-19 15:53:27,917] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] Only static timestamp 2023-02-13 00:00:00.000 +01:00 is used\n",
      "[2025-12-19 15:53:27,921] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] 1 valid timestamp(s) will be used.\n",
      "[2025-12-19 15:53:27,921] INFO in sir3stoolkit.mantle.dataframes: [Resolving tks] Retrieved 524 element(s) of element type ObjectTypes.Pipe.\n",
      "[2025-12-19 15:53:27,921] INFO in sir3stoolkit.mantle.dataframes: [results] Using 31 result properties.\n",
      "[2025-12-19 15:53:27,951] INFO in sir3stoolkit.mantle.dataframes: [results] Retrieving result values...\n",
      "[2025-12-19 15:53:31,469] INFO in sir3stoolkit.mantle.dataframes: [results] Done. Shape: (1, 16244)\n",
      "[2025-12-19 15:53:31,479] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Merging df_metadata with df_results for element type: ObjectTypes.Pipe ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tk</th>\n",
       "      <th>Name</th>\n",
       "      <th>FkdtroRowd</th>\n",
       "      <th>Fkltgr</th>\n",
       "      <th>Fkstrasse</th>\n",
       "      <th>L</th>\n",
       "      <th>Lzu</th>\n",
       "      <th>Rau</th>\n",
       "      <th>Jlambs</th>\n",
       "      <th>Lambda0</th>\n",
       "      <th>Zein</th>\n",
       "      <th>Zaus</th>\n",
       "      <th>Zuml</th>\n",
       "      <th>Asoll</th>\n",
       "      <th>Indschall</th>\n",
       "      <th>Baujahr</th>\n",
       "      <th>Hal</th>\n",
       "      <th>Fkcont</th>\n",
       "      <th>Fk2lrohr</th>\n",
       "      <th>Beschreibung</th>\n",
       "      <th>Idreferenz</th>\n",
       "      <th>Iplanung</th>\n",
       "      <th>Kvr</th>\n",
       "      <th>LineWidthMM</th>\n",
       "      <th>DottedLine</th>\n",
       "      <th>DN</th>\n",
       "      <th>Di</th>\n",
       "      <th>KvrKlartext</th>\n",
       "      <th>HasClosedNSCHs</th>\n",
       "      <th>Tk</th>\n",
       "      <th>Pk</th>\n",
       "      <th>InVariant</th>\n",
       "      <th>Xkor</th>\n",
       "      <th>Ykor</th>\n",
       "      <th>GeometriesDiffer</th>\n",
       "      <th>bz.Fk</th>\n",
       "      <th>bz.Qsvb</th>\n",
       "      <th>bz.Irtrenn</th>\n",
       "      <th>bz.Leckstatus</th>\n",
       "      <th>bz.Leckstart</th>\n",
       "      <th>bz.Leckend</th>\n",
       "      <th>bz.Leckort</th>\n",
       "      <th>bz.Leckmenge</th>\n",
       "      <th>bz.Imptnz</th>\n",
       "      <th>bz.Zvlimptnz</th>\n",
       "      <th>bz.Kantenzv</th>\n",
       "      <th>bz.ITrennWithNSCH</th>\n",
       "      <th>geometry</th>\n",
       "      <th>fkKI</th>\n",
       "      <th>fkKK</th>\n",
       "      <th>A</th>\n",
       "      <th>DTTR</th>\n",
       "      <th>DWVERL</th>\n",
       "      <th>DWVERLABS</th>\n",
       "      <th>IAKTIV</th>\n",
       "      <th>IRTRENN</th>\n",
       "      <th>JV</th>\n",
       "      <th>MVEC</th>\n",
       "      <th>PDAMPF</th>\n",
       "      <th>PHR</th>\n",
       "      <th>PMIN</th>\n",
       "      <th>PVEC</th>\n",
       "      <th>PVECMAX_INST</th>\n",
       "      <th>PVECMIN_INST</th>\n",
       "      <th>QMAV</th>\n",
       "      <th>QMI</th>\n",
       "      <th>QMK</th>\n",
       "      <th>RHOI</th>\n",
       "      <th>RHOK</th>\n",
       "      <th>RHOVEC</th>\n",
       "      <th>SVEC</th>\n",
       "      <th>TI</th>\n",
       "      <th>TK</th>\n",
       "      <th>TTRVEC</th>\n",
       "      <th>TVEC</th>\n",
       "      <th>VAV</th>\n",
       "      <th>VI</th>\n",
       "      <th>VK</th>\n",
       "      <th>VOLDA</th>\n",
       "      <th>WVL</th>\n",
       "      <th>ZVEC</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4614463970292122863</td>\n",
       "      <td>Rohr R-K4383S R-K4183S</td>\n",
       "      <td>4689226368751411179</td>\n",
       "      <td>4779752876656844188</td>\n",
       "      <td>5431845028903382031</td>\n",
       "      <td>7,780674</td>\n",
       "      <td>0</td>\n",
       "      <td>0,05</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1000</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>4713734746689397424</td>\n",
       "      <td>OSM: Knoten 450994211 -&gt; Knoten 476971188; Län...</td>\n",
       "      <td>166815824</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0,00499999987368938</td>\n",
       "      <td>0</td>\n",
       "      <td>999</td>\n",
       "      <td>994</td>\n",
       "      <td>Rücklauf</td>\n",
       "      <td></td>\n",
       "      <td>4614463970292122863</td>\n",
       "      <td>4614463970292122863</td>\n",
       "      <td>False</td>\n",
       "      <td>714262,482930264</td>\n",
       "      <td>5578857,41970231</td>\n",
       "      <td>False</td>\n",
       "      <td>4614463970292122863</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>LINESTRING (714262.483 5578857.42, 714269.543 ...</td>\n",
       "      <td>4730066059089961857</td>\n",
       "      <td>4917189080965035120</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.780674</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-2.837623E-10\\t-2.837623E-10</td>\n",
       "      <td>0.0123</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.615081</td>\n",
       "      <td>1.61508\\t1.688655</td>\n",
       "      <td>1.61508\\t1.688655</td>\n",
       "      <td>1.61508\\t1.688655</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>1000.3</td>\n",
       "      <td>1000.3</td>\n",
       "      <td>1000.3\\t1000.3</td>\n",
       "      <td>0\\t7.780674</td>\n",
       "      <td>9.999994</td>\n",
       "      <td>9.999994</td>\n",
       "      <td>4.795364E+07\\t4.795363E+07</td>\n",
       "      <td>10\\t10</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>545.09\\t544.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4615723899944629797</td>\n",
       "      <td>Rohr V-K203S V-K213S</td>\n",
       "      <td>4689226368751411179</td>\n",
       "      <td>4779752876656844188</td>\n",
       "      <td>5728726059620036726</td>\n",
       "      <td>64,28724</td>\n",
       "      <td>0</td>\n",
       "      <td>0,05</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1000</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>4938076287810941486</td>\n",
       "      <td>OSM: Knoten 390310977 -&gt; Knoten 1368674233; Lä...</td>\n",
       "      <td>24633100</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0,00499999987368938</td>\n",
       "      <td>0</td>\n",
       "      <td>999</td>\n",
       "      <td>994</td>\n",
       "      <td>Vorlauf</td>\n",
       "      <td></td>\n",
       "      <td>4615723899944629797</td>\n",
       "      <td>4615723899944629797</td>\n",
       "      <td>False</td>\n",
       "      <td>713738,296567236</td>\n",
       "      <td>5579219,90221333</td>\n",
       "      <td>False</td>\n",
       "      <td>4615723899944629797</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>LINESTRING (713738.297 5579219.902, 713793.23 ...</td>\n",
       "      <td>5129584372458662150</td>\n",
       "      <td>5332825919690090061</td>\n",
       "      <td>0.0</td>\n",
       "      <td>64.28724</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.983143E-10\\t2.983143E-10\\t2.983143E-10\\t2.98...</td>\n",
       "      <td>0.0123</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.304884</td>\n",
       "      <td>3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...</td>\n",
       "      <td>3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...</td>\n",
       "      <td>3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.3</td>\n",
       "      <td>1000.3</td>\n",
       "      <td>1000.3\\t1000.3\\t1000.3\\t1000.3\\t1000.3\\t1000.3...</td>\n",
       "      <td>0\\t9.183891\\t18.36778\\t27.55167\\t36.73557\\t45....</td>\n",
       "      <td>9.999994</td>\n",
       "      <td>9.999994</td>\n",
       "      <td>203.6129\\t212.7968\\t221.9807\\t231.1646\\t240.34...</td>\n",
       "      <td>10\\t10\\t10\\t10\\t10\\t10\\t10\\t10</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>565.84\\t565.4243\\t565.0086\\t564.5929\\t564.1771...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4621030304810285220</td>\n",
       "      <td>Rohr R-K2573S R-K2583S</td>\n",
       "      <td>5516336706687055417</td>\n",
       "      <td>4779752876656844188</td>\n",
       "      <td>5644881417512616095</td>\n",
       "      <td>3,956838</td>\n",
       "      <td>0</td>\n",
       "      <td>0,05</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1000</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>5625716875961234775</td>\n",
       "      <td>OSM: Knoten 476971211 -&gt; Knoten 264607350; Län...</td>\n",
       "      <td>24386111</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0,00499999987368938</td>\n",
       "      <td>0</td>\n",
       "      <td>100</td>\n",
       "      <td>107,1</td>\n",
       "      <td>Rücklauf</td>\n",
       "      <td></td>\n",
       "      <td>4621030304810285220</td>\n",
       "      <td>4621030304810285220</td>\n",
       "      <td>False</td>\n",
       "      <td>713650,613400257</td>\n",
       "      <td>5578990,48768687</td>\n",
       "      <td>False</td>\n",
       "      <td>4621030304810285220</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>LINESTRING (713650.613 5578990.488, 713649.498...</td>\n",
       "      <td>5070795580168283912</td>\n",
       "      <td>5725848577942138606</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.002291</td>\n",
       "      <td>16.2622</td>\n",
       "      <td>0.064347</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.211137</td>\n",
       "      <td>-4.251046\\t-4.251046</td>\n",
       "      <td>0.198023</td>\n",
       "      <td>0.000835</td>\n",
       "      <td>2.19867</td>\n",
       "      <td>2.210375\\t2.19867</td>\n",
       "      <td>2.210375\\t2.19867</td>\n",
       "      <td>2.210375\\t2.19867</td>\n",
       "      <td>-15.30376</td>\n",
       "      <td>-15.30376</td>\n",
       "      <td>-15.30376</td>\n",
       "      <td>983.7663</td>\n",
       "      <td>983.7645</td>\n",
       "      <td>983.7663\\t983.7645</td>\n",
       "      <td>0\\t3.956838</td>\n",
       "      <td>59.86739</td>\n",
       "      <td>59.871</td>\n",
       "      <td>0.05545082\\t0.05315937</td>\n",
       "      <td>59.8674\\t59.871</td>\n",
       "      <td>-0.479662</td>\n",
       "      <td>-0.479662</td>\n",
       "      <td>-0.479662</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>563.01\\t563.14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    tk                    Name           FkdtroRowd  \\\n",
       "0  4614463970292122863  Rohr R-K4383S R-K4183S  4689226368751411179   \n",
       "1  4615723899944629797    Rohr V-K203S V-K213S  4689226368751411179   \n",
       "2  4621030304810285220  Rohr R-K2573S R-K2583S  5516336706687055417   \n",
       "\n",
       "                Fkltgr            Fkstrasse         L Lzu   Rau Jlambs  \\\n",
       "0  4779752876656844188  5431845028903382031  7,780674   0  0,05      1   \n",
       "1  4779752876656844188  5728726059620036726  64,28724   0  0,05      1   \n",
       "2  4779752876656844188  5644881417512616095  3,956838   0  0,05      1   \n",
       "\n",
       "  Lambda0 Zein Zaus Zuml Asoll Indschall Baujahr Hal               Fkcont  \\\n",
       "0       0    0    0    0  1000         0           0  5029128874972463118   \n",
       "1       0    0    0    0  1000         0           0  5029128874972463118   \n",
       "2       0    0    0    0  1000         0           0  5029128874972463118   \n",
       "\n",
       "              Fk2lrohr                                       Beschreibung  \\\n",
       "0  4713734746689397424  OSM: Knoten 450994211 -> Knoten 476971188; Län...   \n",
       "1  4938076287810941486  OSM: Knoten 390310977 -> Knoten 1368674233; Lä...   \n",
       "2  5625716875961234775  OSM: Knoten 476971211 -> Knoten 264607350; Län...   \n",
       "\n",
       "  Idreferenz Iplanung Kvr          LineWidthMM DottedLine   DN     Di  \\\n",
       "0  166815824        5   2  0,00499999987368938          0  999    994   \n",
       "1   24633100        5   1  0,00499999987368938          0  999    994   \n",
       "2   24386111        0   2  0,00499999987368938          0  100  107,1   \n",
       "\n",
       "  KvrKlartext HasClosedNSCHs                   Tk                   Pk  \\\n",
       "0    Rücklauf                 4614463970292122863  4614463970292122863   \n",
       "1     Vorlauf                 4615723899944629797  4615723899944629797   \n",
       "2    Rücklauf                 4621030304810285220  4621030304810285220   \n",
       "\n",
       "  InVariant              Xkor              Ykor GeometriesDiffer  \\\n",
       "0     False  714262,482930264  5578857,41970231            False   \n",
       "1     False  713738,296567236  5579219,90221333            False   \n",
       "2     False  713650,613400257  5578990,48768687            False   \n",
       "\n",
       "                 bz.Fk bz.Qsvb bz.Irtrenn bz.Leckstatus bz.Leckstart  \\\n",
       "0  4614463970292122863       0          0             0            0   \n",
       "1  4615723899944629797       0          0             0            0   \n",
       "2  4621030304810285220       0          0             0            0   \n",
       "\n",
       "  bz.Leckend bz.Leckort bz.Leckmenge bz.Imptnz bz.Zvlimptnz bz.Kantenzv  \\\n",
       "0          0          0            0         0            0           0   \n",
       "1          0          0            0         0            0           0   \n",
       "2          0          0            0         0            0           0   \n",
       "\n",
       "  bz.ITrennWithNSCH                                           geometry  \\\n",
       "0                 0  LINESTRING (714262.483 5578857.42, 714269.543 ...   \n",
       "1                 0  LINESTRING (713738.297 5579219.902, 713793.23 ...   \n",
       "2                 0  LINESTRING (713650.613 5578990.488, 713649.498...   \n",
       "\n",
       "                  fkKI                 fkKK    A      DTTR   DWVERL DWVERLABS  \\\n",
       "0  4730066059089961857  4917189080965035120  0.0  7.780674      0.0       0.0   \n",
       "1  5129584372458662150  5332825919690090061  0.0  64.28724      0.0       0.0   \n",
       "2  5070795580168283912  5725848577942138606  0.0  0.002291  16.2622  0.064347   \n",
       "\n",
       "  IAKTIV IRTRENN        JV                                               MVEC  \\\n",
       "0    1.0     0.0       0.0                       -2.837623E-10\\t-2.837623E-10   \n",
       "1    1.0     0.0       0.0  2.983143E-10\\t2.983143E-10\\t2.983143E-10\\t2.98...   \n",
       "2    0.0     0.0  0.211137                               -4.251046\\t-4.251046   \n",
       "\n",
       "     PDAMPF       PHR      PMIN  \\\n",
       "0    0.0123       0.0  1.615081   \n",
       "1    0.0123       0.0  3.304884   \n",
       "2  0.198023  0.000835   2.19867   \n",
       "\n",
       "                                                PVEC  \\\n",
       "0                                  1.61508\\t1.688655   \n",
       "1  3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...   \n",
       "2                                  2.210375\\t2.19867   \n",
       "\n",
       "                                        PVECMAX_INST  \\\n",
       "0                                  1.61508\\t1.688655   \n",
       "1  3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...   \n",
       "2                                  2.210375\\t2.19867   \n",
       "\n",
       "                                        PVECMIN_INST      QMAV       QMI  \\\n",
       "0                                  1.61508\\t1.688655      -0.0      -0.0   \n",
       "1  3.304885\\t3.345665\\t3.386445\\t3.427225\\t3.4680...       0.0       0.0   \n",
       "2                                  2.210375\\t2.19867 -15.30376 -15.30376   \n",
       "\n",
       "        QMK      RHOI      RHOK  \\\n",
       "0      -0.0    1000.3    1000.3   \n",
       "1       0.0    1000.3    1000.3   \n",
       "2 -15.30376  983.7663  983.7645   \n",
       "\n",
       "                                              RHOVEC  \\\n",
       "0                                     1000.3\\t1000.3   \n",
       "1  1000.3\\t1000.3\\t1000.3\\t1000.3\\t1000.3\\t1000.3...   \n",
       "2                                 983.7663\\t983.7645   \n",
       "\n",
       "                                                SVEC        TI        TK  \\\n",
       "0                                        0\\t7.780674  9.999994  9.999994   \n",
       "1  0\\t9.183891\\t18.36778\\t27.55167\\t36.73557\\t45....  9.999994  9.999994   \n",
       "2                                        0\\t3.956838  59.86739    59.871   \n",
       "\n",
       "                                              TTRVEC  \\\n",
       "0                         4.795364E+07\\t4.795363E+07   \n",
       "1  203.6129\\t212.7968\\t221.9807\\t231.1646\\t240.34...   \n",
       "2                             0.05545082\\t0.05315937   \n",
       "\n",
       "                             TVEC       VAV        VI        VK VOLDA  WVL  \\\n",
       "0                          10\\t10      -0.0      -0.0      -0.0   0.0  0.0   \n",
       "1  10\\t10\\t10\\t10\\t10\\t10\\t10\\t10       0.0       0.0       0.0   0.0  0.0   \n",
       "2                 59.8674\\t59.871 -0.479662 -0.479662 -0.479662   0.0  0.0   \n",
       "\n",
       "                                                ZVEC  \n",
       "0                                     545.09\\t544.34  \n",
       "1  565.84\\t565.4243\\t565.0086\\t564.5929\\t564.1771...  \n",
       "2                                     563.01\\t563.14  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(s3s.generate_element_dataframe(element_type=s3s.ObjectTypes.Pipe, tks=None)).head(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "219eb668",
   "metadata": {},
   "source": [
    "As can be seen some result values are in vectorized form, since pipes have result values that are calculated for interior points."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "808b2c79",
   "metadata": {},
   "source": [
    "## DistrictHeatingConsumer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "71e17335",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[2025-12-19 15:53:31,529] INFO in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df for element type: ObjectTypes.DistrictHeatingConsumer ...\n",
      "[2025-12-19 15:53:31,530] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_metadata for element type: ObjectTypes.DistrictHeatingConsumer ...\n",
      "[2025-12-19 15:53:31,531] INFO in sir3stoolkit.mantle.dataframes: [metadata] Generating metadata dataframe for element type: ObjectTypes.DistrictHeatingConsumer\n",
      "[2025-12-19 15:53:31,532] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieved 337 element(s) of element type ObjectTypes.DistrictHeatingConsumer.\n",
      "[2025-12-19 15:53:31,534] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] No properties given → using ALL metadata properties for ObjectTypes.DistrictHeatingConsumer.\n",
      "[2025-12-19 15:53:31,536] INFO in sir3stoolkit.mantle.dataframes: [Resolving Metadata Properties] Using 55 metadata properties.\n",
      "[2025-12-19 15:53:31,537] INFO in sir3stoolkit.mantle.dataframes: [metadata] Retrieving metadata properties ['Name', 'Beschreibung', 'Ind0', 'W0', 'Qm0', 'Tvl0', 'Trs0', 'Lfk', 'Rho0', 'Dtmin', 'Indtr', 'Trsk', 'Fktrft', 'A', 'B', 'C', 'Vtyp', 'V0', 'P1soll', 'Dpvlmin', 'Fkzep1vl', 'Tsvl', 'Zevk', 'Dphaus', 'Dprlmin', 'Fkzep1rl', 'Tsrl', 'Imbg', 'Irfv', 'Fkcont', 'Idreferenz', 'Iplanung', 'CPM', 'NumberOfVERB', 'IndtrKlartext', 'M0Estimated', 'W0Estimated', 'Tk', 'Pk', 'InVariant', 'Xkor', 'Ykor', 'ShowDescription', 'PositionOfDescription', 'Angle', 'SymbolFactor', 'GeometriesDiffer', 'bz.Fk', 'bz.Indlast', 'bz.Indlfkt2', 'bz.Fklfkt', 'bz.Fklfkt2', 'bz.Fkqvar', 'bz.Fktevt', 'bz.IndlastKlartext'], geometry, end nodes...\n",
      "[2025-12-19 15:53:32,632] INFO in sir3stoolkit.mantle.dataframes: [metadata] 2 non-empty end node columns were created.\n",
      "[2025-12-19 15:53:32,645] INFO in sir3stoolkit.mantle.dataframes: [metadata] Transforming DataFrame to GeoDataFrame successful with EPSG: 25832\n",
      "[2025-12-19 15:53:32,647] INFO in sir3stoolkit.mantle.dataframes: [metadata] Done. Shape: (337, 59)\n",
      "[2025-12-19 15:53:32,647] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_results for element type: ObjectTypes.DistrictHeatingConsumer ...\n",
      "[2025-12-19 15:53:32,805] INFO in sir3stoolkit.mantle.dataframes: [results] Generating results dataframe for element type: ObjectTypes.DistrictHeatingConsumer\n",
      "[2025-12-19 15:53:32,985] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] Only static timestamp 2023-02-13 00:00:00.000 +01:00 is used\n",
      "[2025-12-19 15:53:32,986] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] 1 valid timestamp(s) will be used.\n",
      "[2025-12-19 15:53:32,987] INFO in sir3stoolkit.mantle.dataframes: [Resolving tks] Retrieved 337 element(s) of element type ObjectTypes.DistrictHeatingConsumer.\n",
      "[2025-12-19 15:53:32,987] INFO in sir3stoolkit.mantle.dataframes: [results] Using 20 result properties.\n",
      "[2025-12-19 15:53:33,025] INFO in sir3stoolkit.mantle.dataframes: [results] Retrieving result values...\n",
      "[2025-12-19 15:53:34,118] INFO in sir3stoolkit.mantle.dataframes: [results] Done. Shape: (1, 6740)\n",
      "[2025-12-19 15:53:34,118] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Merging df_metadata with df_results for element type: ObjectTypes.DistrictHeatingConsumer ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tk</th>\n",
       "      <th>Name</th>\n",
       "      <th>Beschreibung</th>\n",
       "      <th>Ind0</th>\n",
       "      <th>W0</th>\n",
       "      <th>Qm0</th>\n",
       "      <th>Tvl0</th>\n",
       "      <th>Trs0</th>\n",
       "      <th>Lfk</th>\n",
       "      <th>Rho0</th>\n",
       "      <th>Dtmin</th>\n",
       "      <th>Indtr</th>\n",
       "      <th>Trsk</th>\n",
       "      <th>Fktrft</th>\n",
       "      <th>A</th>\n",
       "      <th>B</th>\n",
       "      <th>C</th>\n",
       "      <th>Vtyp</th>\n",
       "      <th>V0</th>\n",
       "      <th>P1soll</th>\n",
       "      <th>Dpvlmin</th>\n",
       "      <th>Fkzep1vl</th>\n",
       "      <th>Tsvl</th>\n",
       "      <th>Zevk</th>\n",
       "      <th>Dphaus</th>\n",
       "      <th>Dprlmin</th>\n",
       "      <th>Fkzep1rl</th>\n",
       "      <th>Tsrl</th>\n",
       "      <th>Imbg</th>\n",
       "      <th>Irfv</th>\n",
       "      <th>Fkcont</th>\n",
       "      <th>Idreferenz</th>\n",
       "      <th>Iplanung</th>\n",
       "      <th>CPM</th>\n",
       "      <th>NumberOfVERB</th>\n",
       "      <th>IndtrKlartext</th>\n",
       "      <th>M0Estimated</th>\n",
       "      <th>W0Estimated</th>\n",
       "      <th>Tk</th>\n",
       "      <th>Pk</th>\n",
       "      <th>InVariant</th>\n",
       "      <th>Xkor</th>\n",
       "      <th>Ykor</th>\n",
       "      <th>ShowDescription</th>\n",
       "      <th>PositionOfDescription</th>\n",
       "      <th>Angle</th>\n",
       "      <th>SymbolFactor</th>\n",
       "      <th>GeometriesDiffer</th>\n",
       "      <th>bz.Fk</th>\n",
       "      <th>bz.Indlast</th>\n",
       "      <th>bz.Indlfkt2</th>\n",
       "      <th>bz.Fklfkt</th>\n",
       "      <th>bz.Fklfkt2</th>\n",
       "      <th>bz.Fkqvar</th>\n",
       "      <th>bz.Fktevt</th>\n",
       "      <th>bz.IndlastKlartext</th>\n",
       "      <th>geometry</th>\n",
       "      <th>fkKI</th>\n",
       "      <th>fkKK</th>\n",
       "      <th>DH</th>\n",
       "      <th>DP</th>\n",
       "      <th>DPH</th>\n",
       "      <th>IAKTIV</th>\n",
       "      <th>INDUV</th>\n",
       "      <th>LFH</th>\n",
       "      <th>LFT</th>\n",
       "      <th>M</th>\n",
       "      <th>MHYUV</th>\n",
       "      <th>MTHUV</th>\n",
       "      <th>PHIRL</th>\n",
       "      <th>PHIVL</th>\n",
       "      <th>QM</th>\n",
       "      <th>RHOI</th>\n",
       "      <th>RHOK</th>\n",
       "      <th>TI</th>\n",
       "      <th>TK</th>\n",
       "      <th>TVMIN</th>\n",
       "      <th>W</th>\n",
       "      <th>WSOLL</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4611752310942477664</td>\n",
       "      <td>Fernwärmeverbraucher V-K1203S R-K3683S</td>\n",
       "      <td>Gattendorf;95185;Obere Au;28;None;yes</td>\n",
       "      <td>0</td>\n",
       "      <td>139,0433</td>\n",
       "      <td>1</td>\n",
       "      <td>90</td>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>1000</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>-1</td>\n",
       "      <td>2</td>\n",
       "      <td>-0,25</td>\n",
       "      <td>-2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0,3</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>830887238</td>\n",
       "      <td>1</td>\n",
       "      <td>4,19029998779297</td>\n",
       "      <td>0</td>\n",
       "      <td>Tabelle Temperatur TEVT, TRS(t)</td>\n",
       "      <td>3,981862</td>\n",
       "      <td>34,91917</td>\n",
       "      <td>4611752310942477664</td>\n",
       "      <td>4611752310942477664</td>\n",
       "      <td>False</td>\n",
       "      <td>713675,30023234</td>\n",
       "      <td>5578705,1927566</td>\n",
       "      <td>False</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0,1</td>\n",
       "      <td>False</td>\n",
       "      <td>4611752310942477664</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4835417738045943522</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "      <td>5395645951786400348</td>\n",
       "      <td>Lastfaktor thermisch</td>\n",
       "      <td>POINT (713675.3 5578705.193)</td>\n",
       "      <td>4673701597187411685</td>\n",
       "      <td>4995788945387711669</td>\n",
       "      <td>17.178450</td>\n",
       "      <td>1.583806</td>\n",
       "      <td>1.583806</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0.288343</td>\n",
       "      <td>0.283131</td>\n",
       "      <td>0.318879</td>\n",
       "      <td>-0.829086</td>\n",
       "      <td>-0.829086</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>1.147966</td>\n",
       "      <td>966.0245</td>\n",
       "      <td>983.7</td>\n",
       "      <td>89.4592</td>\n",
       "      <td>60.0</td>\n",
       "      <td>68.50781</td>\n",
       "      <td>39.36750</td>\n",
       "      <td>39.36750</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4612528660388965271</td>\n",
       "      <td>Fernwärmeverbraucher V-K1783S R-K4263S</td>\n",
       "      <td>None;None;None;None;None;yes</td>\n",
       "      <td>0</td>\n",
       "      <td>386,4134</td>\n",
       "      <td>1</td>\n",
       "      <td>90</td>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>1000</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>-1</td>\n",
       "      <td>2</td>\n",
       "      <td>-0,25</td>\n",
       "      <td>-2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0,3</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>1056287317</td>\n",
       "      <td>1</td>\n",
       "      <td>4,19029998779297</td>\n",
       "      <td>0</td>\n",
       "      <td>Tabelle Temperatur TEVT, TRS(t)</td>\n",
       "      <td>11,06594</td>\n",
       "      <td>34,91917</td>\n",
       "      <td>4612528660388965271</td>\n",
       "      <td>4612528660388965271</td>\n",
       "      <td>False</td>\n",
       "      <td>714251,332395179</td>\n",
       "      <td>5578925,00052798</td>\n",
       "      <td>False</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0,1</td>\n",
       "      <td>False</td>\n",
       "      <td>4612528660388965271</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5554262436821166605</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "      <td>5395645951786400348</td>\n",
       "      <td>Lastfaktor thermisch</td>\n",
       "      <td>POINT (714251.332 5578925.001)</td>\n",
       "      <td>5015101891725198603</td>\n",
       "      <td>5751808837348052764</td>\n",
       "      <td>0.069769</td>\n",
       "      <td>0.006844</td>\n",
       "      <td>0.006844</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.3000</td>\n",
       "      <td>983.7</td>\n",
       "      <td>10.0000</td>\n",
       "      <td>60.0</td>\n",
       "      <td>10.00000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4612562908060328263</td>\n",
       "      <td>Fernwärmeverbraucher V-K1623S R-K4103S</td>\n",
       "      <td>Gattendorf;95185;Langenbachstraße;4;None;yes</td>\n",
       "      <td>0</td>\n",
       "      <td>106,6409</td>\n",
       "      <td>1</td>\n",
       "      <td>90</td>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>1000</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>-1</td>\n",
       "      <td>2</td>\n",
       "      <td>-0,25</td>\n",
       "      <td>-2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0,2</td>\n",
       "      <td>0,3</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>5029128874972463118</td>\n",
       "      <td>830818182</td>\n",
       "      <td>1</td>\n",
       "      <td>4,19029998779297</td>\n",
       "      <td>0</td>\n",
       "      <td>Tabelle Temperatur TEVT, TRS(t)</td>\n",
       "      <td>3,053936</td>\n",
       "      <td>34,91917</td>\n",
       "      <td>4612562908060328263</td>\n",
       "      <td>4612562908060328263</td>\n",
       "      <td>False</td>\n",
       "      <td>713271,271817449</td>\n",
       "      <td>5578979,74264398</td>\n",
       "      <td>False</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0,1</td>\n",
       "      <td>False</td>\n",
       "      <td>4612562908060328263</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4835417738045943522</td>\n",
       "      <td></td>\n",
       "      <td>-1</td>\n",
       "      <td>5395645951786400348</td>\n",
       "      <td>Lastfaktor thermisch</td>\n",
       "      <td>POINT (713271.272 5578979.743)</td>\n",
       "      <td>4965299629814639205</td>\n",
       "      <td>4779536530687993701</td>\n",
       "      <td>16.757140</td>\n",
       "      <td>1.562662</td>\n",
       "      <td>1.562662</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0.287407</td>\n",
       "      <td>0.283131</td>\n",
       "      <td>0.243774</td>\n",
       "      <td>-0.633813</td>\n",
       "      <td>-0.633813</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>-3.333333e+32</td>\n",
       "      <td>0.877587</td>\n",
       "      <td>965.9670</td>\n",
       "      <td>983.7</td>\n",
       "      <td>89.5549</td>\n",
       "      <td>60.0</td>\n",
       "      <td>68.50781</td>\n",
       "      <td>30.19337</td>\n",
       "      <td>30.19337</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    tk                                    Name  \\\n",
       "0  4611752310942477664  Fernwärmeverbraucher V-K1203S R-K3683S   \n",
       "1  4612528660388965271  Fernwärmeverbraucher V-K1783S R-K4263S   \n",
       "2  4612562908060328263  Fernwärmeverbraucher V-K1623S R-K4103S   \n",
       "\n",
       "                                   Beschreibung Ind0        W0 Qm0 Tvl0 Trs0  \\\n",
       "0         Gattendorf;95185;Obere Au;28;None;yes    0  139,0433   1   90   60   \n",
       "1                  None;None;None;None;None;yes    0  386,4134   1   90   60   \n",
       "2  Gattendorf;95185;Langenbachstraße;4;None;yes    0  106,6409   1   90   60   \n",
       "\n",
       "  Lfk  Rho0 Dtmin Indtr Trsk Fktrft  A      B   C Vtyp V0 P1soll Dpvlmin  \\\n",
       "0   1  1000     3     3   60     -1  2  -0,25  -2    1  1      0       0   \n",
       "1   1  1000     3     3   60     -1  2  -0,25  -2    1  0      0       0   \n",
       "2   1  1000     3     3   60     -1  2  -0,25  -2    1  1      0       0   \n",
       "\n",
       "  Fkzep1vl Tsvl Zevk Dphaus Dprlmin Fkzep1rl Tsrl Imbg Irfv  \\\n",
       "0       -1    0    0    0,2     0,3       -1    0    0    1   \n",
       "1       -1    0    0    0,2     0,3       -1    0    0    1   \n",
       "2       -1    0    0    0,2     0,3       -1    0    0    1   \n",
       "\n",
       "                Fkcont  Idreferenz Iplanung               CPM NumberOfVERB  \\\n",
       "0  5029128874972463118   830887238        1  4,19029998779297            0   \n",
       "1  5029128874972463118  1056287317        1  4,19029998779297            0   \n",
       "2  5029128874972463118   830818182        1  4,19029998779297            0   \n",
       "\n",
       "                     IndtrKlartext M0Estimated W0Estimated  \\\n",
       "0  Tabelle Temperatur TEVT, TRS(t)    3,981862    34,91917   \n",
       "1  Tabelle Temperatur TEVT, TRS(t)    11,06594    34,91917   \n",
       "2  Tabelle Temperatur TEVT, TRS(t)    3,053936    34,91917   \n",
       "\n",
       "                    Tk                   Pk InVariant              Xkor  \\\n",
       "0  4611752310942477664  4611752310942477664     False   713675,30023234   \n",
       "1  4612528660388965271  4612528660388965271     False  714251,332395179   \n",
       "2  4612562908060328263  4612562908060328263     False  713271,271817449   \n",
       "\n",
       "               Ykor ShowDescription PositionOfDescription Angle SymbolFactor  \\\n",
       "0   5578705,1927566           False                     3     0          0,1   \n",
       "1  5578925,00052798           False                     3     0          0,1   \n",
       "2  5578979,74264398           False                     3     0          0,1   \n",
       "\n",
       "  GeometriesDiffer                bz.Fk bz.Indlast bz.Indlfkt2  \\\n",
       "0            False  4611752310942477664          0           0   \n",
       "1            False  4612528660388965271          0           0   \n",
       "2            False  4612562908060328263          0           0   \n",
       "\n",
       "             bz.Fklfkt bz.Fklfkt2 bz.Fkqvar            bz.Fktevt  \\\n",
       "0  4835417738045943522                   -1  5395645951786400348   \n",
       "1  5554262436821166605                   -1  5395645951786400348   \n",
       "2  4835417738045943522                   -1  5395645951786400348   \n",
       "\n",
       "     bz.IndlastKlartext                        geometry                 fkKI  \\\n",
       "0  Lastfaktor thermisch    POINT (713675.3 5578705.193)  4673701597187411685   \n",
       "1  Lastfaktor thermisch  POINT (714251.332 5578925.001)  5015101891725198603   \n",
       "2  Lastfaktor thermisch  POINT (713271.272 5578979.743)  4965299629814639205   \n",
       "\n",
       "                  fkKK         DH        DP       DPH  IAKTIV  INDUV  \\\n",
       "0  4995788945387711669  17.178450  1.583806  1.583806     0.0   -1.0   \n",
       "1  5751808837348052764   0.069769  0.006844  0.006844     1.0   -1.0   \n",
       "2  4779536530687993701  16.757140  1.562662  1.562662     0.0   -1.0   \n",
       "\n",
       "        LFH       LFT         M     MHYUV     MTHUV         PHIRL  \\\n",
       "0  0.288343  0.283131  0.318879 -0.829086 -0.829086 -3.333333e+32   \n",
       "1  0.000000  0.000000  0.000000  0.000000  0.000000 -3.333333e+32   \n",
       "2  0.287407  0.283131  0.243774 -0.633813 -0.633813 -3.333333e+32   \n",
       "\n",
       "          PHIVL        QM       RHOI   RHOK       TI    TK     TVMIN  \\\n",
       "0 -3.333333e+32  1.147966   966.0245  983.7  89.4592  60.0  68.50781   \n",
       "1 -3.333333e+32  0.000000  1000.3000  983.7  10.0000  60.0  10.00000   \n",
       "2 -3.333333e+32  0.877587   965.9670  983.7  89.5549  60.0  68.50781   \n",
       "\n",
       "          W     WSOLL  \n",
       "0  39.36750  39.36750  \n",
       "1   0.00000   0.00000  \n",
       "2  30.19337  30.19337  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(s3s.generate_element_dataframe(element_type=s3s.ObjectTypes.DistrictHeatingConsumer, tks=None)).head(3)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}