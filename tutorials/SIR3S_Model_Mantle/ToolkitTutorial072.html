

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 72: WORK IN PROGRESS: Longitudinal Sections &mdash; sir3stoolkit  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            sir3stoolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Application Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers.html">For Developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">sir3stoolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial 72: WORK IN PROGRESS: Longitudinal Sections</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/SIR3S_Model_Mantle/ToolkitTutorial072.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Tutorial-72:-WORK-IN-PROGRESS:-Longitudinal-Sections">
<h1>Tutorial 72: WORK IN PROGRESS: Longitudinal Sections<a class="headerlink" href="#Tutorial-72:-WORK-IN-PROGRESS:-Longitudinal-Sections" title="Link to this heading"></a></h1>
<p>This example demonstrates how to …</p>
</section>
<section id="SIR-3S-Installation">
<h1>SIR 3S Installation<a class="headerlink" href="#SIR-3S-Installation" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>SIR3S_SIRGRAF_DIR = r&quot;C:\3S\SIR 3S\SirGraf-90-15-00-20x64_Quebec-Upd1&quot; #change to local path
</pre></div>
</div>
</div>
</section>
<section id="Imports">
<h1>Imports<a class="headerlink" href="#Imports" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from sir3stoolkit.core import wrapper
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from sir3stoolkit.mantle import mantle
</pre></div>
</div>
</div>
<p>The wrapper package has to be initialized with reference to a SIR 3S (SirGraf) installation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>wrapper.Initialize_Toolkit(SIR3S_SIRGRAF_DIR)
</pre></div>
</div>
</div>
<section id="Additional-imports">
<h2>Additional imports<a class="headerlink" href="#Additional-imports" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
</pre></div>
</div>
</div>
<p>…</p>
</section>
</section>
<section id="Initialization">
<h1>Initialization<a class="headerlink" href="#Initialization" title="Link to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>s3s = mantle.SIR3S_Model_Mantle()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initialization complete
</pre></div></div>
</div>
</section>
<section id="Open-Model">
<h1>Open Model<a class="headerlink" href="#Open-Model" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dbFilePath=r&quot;C:\Users\aUsername\3S\PT3S\PT3S\Examples\Example3.db3&quot;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>s3s.OpenModel(dbName=dbFilePath,
              providerType=s3s.ProviderTypes.SQLite,
              Mid=&quot;M-1-0-1&quot;,
              saveCurrentlyOpenModel=False,
              namedInstance=&quot;&quot;,
              userID=&quot;&quot;,
              password=&quot;&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model is open for further operation
</pre></div></div>
</div>
</section>
<section id="Get-Data">
<h1>Get Data<a class="headerlink" href="#Get-Data" title="Link to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>s3s.ExecCalculation(True)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Could not start Model Calculation: SirCalc Path &#39;C:\3S Consult\SIR3S-90-15-00-19-Quebec\SirCalc-90-15-02-20_Quebec\SirCalc.exe&#39; not found.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dfs = s3s.generate_longitudinal_section_dataframes()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[2026-01-18 22:35:34,457] INFO in sir3stoolkit.mantle.dataframes: [model_data] Generating model_data dataframe for element type: ObjectTypes.AGSN_HydraulicProfile
[2026-01-18 22:35:34,469] INFO in sir3stoolkit.mantle.dataframes: [model_data] Retrieved 3 element(s) of element type ObjectTypes.AGSN_HydraulicProfile.
[2026-01-18 22:35:34,495] INFO in sir3stoolkit.mantle.dataframes: [Resolving model_data Properties] No properties given → using ALL model_data properties for ObjectTypes.AGSN_HydraulicProfile.
[2026-01-18 22:35:34,496] INFO in sir3stoolkit.mantle.dataframes: [Resolving model_data Properties] Using 9 model_data properties.
[2026-01-18 22:35:34,497] INFO in sir3stoolkit.mantle.dataframes: [model_data] Retrieving model_data properties [&#39;Name&#39;, &#39;Lfdnr&#39;, &#39;Aktiv&#39;, &#39;AllNodesAndLinks&#39;, &#39;ObjsString&#39;, &#39;MainWay&#39;, &#39;Tk&#39;, &#39;Pk&#39;, &#39;InVariant&#39;]...
[2026-01-18 22:35:34,576] INFO in sir3stoolkit.mantle.dataframes: [model_data] Done. Shape: (3, 10)
[2026-01-18 22:35:34,583] INFO in sir3stoolkit.mantle.dataframes: Retrieving Hydraulic Profile with Lfdnr: 1.
[2026-01-18 22:35:34,610] INFO in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df for element type: ObjectTypes.Pipe ...
[2026-01-18 22:35:34,612] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_model_data for element type: ObjectTypes.Pipe ...
[2026-01-18 22:35:34,613] INFO in sir3stoolkit.mantle.dataframes: [model_data] Generating model_data dataframe for element type: ObjectTypes.Pipe
[2026-01-18 22:35:34,619] INFO in sir3stoolkit.mantle.dataframes: [Resolving tks] Retrieved 524 element(s) of element type ObjectTypes.Pipe.
[2026-01-18 22:35:34,622] INFO in sir3stoolkit.mantle.dataframes: [Resolving tks] 44 tks remain after filtering for given tks.
[2026-01-18 22:35:34,625] INFO in sir3stoolkit.mantle.dataframes: [Resolving model_data Properties] No properties given → using ALL model_data properties for ObjectTypes.Pipe.
[2026-01-18 22:35:34,629] INFO in sir3stoolkit.mantle.dataframes: [Resolving model_data Properties] Using 46 model_data properties.
[2026-01-18 22:35:34,631] INFO in sir3stoolkit.mantle.dataframes: [model_data] Retrieving model_data properties [&#39;Name&#39;, &#39;FkdtroRowd&#39;, &#39;Fkltgr&#39;, &#39;Fkstrasse&#39;, &#39;L&#39;, &#39;Lzu&#39;, &#39;Rau&#39;, &#39;Jlambs&#39;, &#39;Lambda0&#39;, &#39;Zein&#39;, &#39;Zaus&#39;, &#39;Zuml&#39;, &#39;Asoll&#39;, &#39;Indschall&#39;, &#39;Baujahr&#39;, &#39;Hal&#39;, &#39;Fkcont&#39;, &#39;Fk2lrohr&#39;, &#39;Beschreibung&#39;, &#39;Idreferenz&#39;, &#39;Iplanung&#39;, &#39;Kvr&#39;, &#39;LineWidthMM&#39;, &#39;DottedLine&#39;, &#39;DN&#39;, &#39;Di&#39;, &#39;KvrKlartext&#39;, &#39;HasClosedNSCHs&#39;, &#39;Tk&#39;, &#39;Pk&#39;, &#39;InVariant&#39;, &#39;Xkor&#39;, &#39;Ykor&#39;, &#39;GeometriesDiffer&#39;, &#39;bz.Fk&#39;, &#39;bz.Qsvb&#39;, &#39;bz.Irtrenn&#39;, &#39;bz.Leckstatus&#39;, &#39;bz.Leckstart&#39;, &#39;bz.Leckend&#39;, &#39;bz.Leckort&#39;, &#39;bz.Leckmenge&#39;, &#39;bz.Imptnz&#39;, &#39;bz.Zvlimptnz&#39;, &#39;bz.Kantenzv&#39;, &#39;bz.ITrennWithNSCH&#39;], geometry, end nodes...
[2026-01-18 22:35:35,698] INFO in sir3stoolkit.mantle.dataframes: [model_data] 2 non-empty end node columns were created.
[2026-01-18 22:35:35,900] INFO in sir3stoolkit.mantle.dataframes: [model_data] Transforming DataFrame to GeoDataFrame successful with EPSG: 25832
[2026-01-18 22:35:35,900] INFO in sir3stoolkit.mantle.dataframes: [model_data] Done. Shape: (44, 50)
[2026-01-18 22:35:35,905] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Generating df_results for element type: ObjectTypes.Pipe ...
[2026-01-18 22:35:35,912] INFO in sir3stoolkit.mantle.dataframes: [results] Generating results dataframe for element type: ObjectTypes.Pipe
[2026-01-18 22:35:35,928] WARNING in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] Timestamp  is not valid (SIR3S_Model.GetTimeStamps()). It will be excluded.
[2026-01-18 22:35:35,930] INFO in sir3stoolkit.mantle.dataframes: [Resolving Timestamps] 0 valid timestamp(s) will be used.
[2026-01-18 22:35:35,930] WARNING in sir3stoolkit.mantle.dataframes: [results] No valid timestamps. Returning empty dataframe.
[2026-01-18 22:35:35,934] DEBUG in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Merging df_model_data with df_results for element type: ObjectTypes.Pipe ...
[2026-01-18 22:35:35,935] ERROR in sir3stoolkit.mantle.dataframes: [generate_element_dataframe] Error Generating df for element type: ObjectTypes.Pipe: Too many levels: Index has only 1 level, not 2
ERROR:root:Error retrieving Hydraulic Profile with Lfdnr: 1.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error :
Error :
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df=dfs[0]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">IndexError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[11], line 1</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> df<span style="color: rgb(98,98,98)">=</span>dfs[<span style="color: rgb(98,98,98)">0</span>]

<span class="ansi-red-intense-fg ansi-bold">IndexError</span>: list index out of range
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_vec=s3s.add_interior_points_as_multiindex(df)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_vec[(&quot;l_sum&quot;, -1)]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0       15.351701
1       27.860648
2       34.126153
3       48.533695
4       62.049538
5       79.324254
6      113.666420
7      149.752335
8      213.782486
9      265.851250
10     315.314808
11     325.177948
12     339.208532
13     371.733842
14     378.362803
15     448.136789
16     463.003848
17     562.262027
18     620.887233
19     708.601420
20     735.670985
21     740.545722
22     743.968120
23     751.727923
24     758.287896
25     777.158410
26     795.942267
27     828.020167
28     841.297316
29     911.066336
30     947.495684
31    1004.713492
32    1045.708308
33    1052.541387
34    1060.034488
35    1068.355962
36    1151.294797
37    1155.836302
38    1161.025165
39    1164.982003
40    1186.143680
41    1212.402452
42    1240.748040
43    1281.552541
Name: (l_sum, -1), dtype: float64
</pre></div></div>
</div>
</section>
<section id="Plot">
<h1>Plot<a class="headerlink" href="#Plot" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>from __future__ import annotations

from collections import OrderedDict
from typing import Any

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.ticker as mticker


def plot_time_curves(
    df: pd.DataFrame,
    start=None,
    end=None,
    properties=None,
    axis_labels=None,
    ylims=None,
    tks_per_property=None,      # kept for signature compatibility (unused in new logic)
    y_label_ticks=None,
    y_grid_ticks=None,
    x_label_ticks=None,
    x_grid_ticks=None,
    figsize=(20, 14),
    axis_offset=60,
    linestyles=None,
    legend=True,
    legend_fontsize=8,
    legend_loc=&quot;upper left&quot;,
    legend_coords=(0.67, 0.33),
    legend_in_figure=True,
    missing=&quot;skip&quot;,
    normalize=str.upper,
    aliases=None,
    title_prefix=&quot;&quot;,
    show_title=True,
    rotate_xticks=0,
    grid=True,
    grid_style=&quot;--&quot;,
    grid_alpha=0.3,
    logger=None,
):
    &quot;&quot;&quot;
    Plot multiple properties along cumulative length.

    Expected columns:
      - (&quot;l_sum&quot;, -1): cumulative segment end length
      - (&quot;VAV&quot;, -1): direction; negative reverses sample order within the segment
      - For each property P in `properties`: columns (P, k) with k=0..N (level1 numeric),
        and optionally (P, -1) metadata (ignored).

    Segment definition:
      row i spans x in [l_sum[i-1], l_sum[i]] with l_sum[-1] := 0.

    For each row + property:
      - take samples from k=0 up to last non-NaN (trailing NaNs)
      - map to equidistant x over the segment
      - reverse samples if VAV &lt; 0
    &quot;&quot;&quot;

    # -------------------------------------------------------------------------
    # Logging helpers
    # -------------------------------------------------------------------------
    def _log_info(msg: str) -&gt; None:
        if logger is not None:
            logger.info(f&quot;[time curves] {msg}&quot;)

    def _log_warn(msg: str) -&gt; None:
        if logger is not None and hasattr(logger, &quot;warning&quot;):
            logger.warning(f&quot;[time curves] {msg}&quot;)
        elif logger is not None:
            logger.info(f&quot;[time curves] {msg}&quot;)

    # -------------------------------------------------------------------------
    # Input validation
    # -------------------------------------------------------------------------
    if not isinstance(df.columns, pd.MultiIndex) or df.columns.nlevels != 2:
        raise ValueError(&quot;DataFrame must have 2-level MultiIndex columns (level0=property, level1=sample index).&quot;)

    df = df.copy()

    lvl0_name = df.columns.names[0] or &quot;property&quot;
    lvl1_name = df.columns.names[1] or &quot;sample&quot;

    def norm_prop(s: Any) -&gt; str:
        s2 = normalize(str(s)).strip()
        if aliases:
            s2 = aliases.get(s2, s2)
        return s2

    lvl0_raw = df.columns.get_level_values(0).astype(str)
    lvl0_norm = lvl0_raw.map(norm_prop)
    lvl1_vals = df.columns.get_level_values(1)

    def _is_minus_one(x: Any) -&gt; bool:
        return (x == -1) or (str(x).strip() == &quot;-1&quot;)

    # Find special columns (&quot;l_sum&quot;,-1), (&quot;VAV&quot;,-1)
    lsum_key_norm = norm_prop(&quot;l_sum&quot;)
    vav_key_norm = norm_prop(&quot;VAV&quot;)

    lsum_mask = (lvl0_norm == lsum_key_norm) &amp; pd.Index(lvl1_vals).map(_is_minus_one)
    vav_mask = (lvl0_norm == vav_key_norm) &amp; pd.Index(lvl1_vals).map(_is_minus_one)




    lvl1_idx = pd.Index(lvl1_vals)

    lsum_mask = ((lvl0_norm == lsum_key_norm) &amp; lvl1_idx.map(_is_minus_one)).to_numpy()
    vav_mask  = ((lvl0_norm == vav_key_norm)  &amp; lvl1_idx.map(_is_minus_one)).to_numpy()

    if np.count_nonzero(lsum_mask) != 1:
        raise ValueError(f&quot;Expected exactly one (&#39;l_sum&#39;, -1) column, found {np.count_nonzero(lsum_mask)}.&quot;)
    if np.count_nonzero(vav_mask) != 1:
        raise ValueError(f&quot;Expected exactly one (&#39;VAV&#39;, -1) column, found {np.count_nonzero(vav_mask)}.&quot;)


    lsum_col = df.columns[lsum_mask][0]
    vav_col = df.columns[vav_mask][0]

    # Ensure l_sum numeric and sort by it
    lsum_series = pd.to_numeric(df[lsum_col], errors=&quot;coerce&quot;)
    if lsum_series.isna().any():
        bad = df.index[lsum_series.isna()].tolist()[:10]
        raise ValueError(f&quot;Some l_sum values are NaN/non-numeric. Example rows: {bad}&quot;)

    df = df.loc[lsum_series.sort_values().index]
    lsum = lsum_series.loc[df.index].to_numpy(dtype=float)

    # Segment starts/ends
    seg_end = lsum
    seg_start = np.concatenate(([0.0], seg_end[:-1]))

    # Interpret start/end as length bounds
    start_l = float(start) if start is not None else 0.0
    end_l = float(end) if end is not None else float(seg_end.max())
    if start_l &gt; end_l:
        raise ValueError(&quot;start must be &lt;= end (interpreted as length range).&quot;)

    overlaps = (seg_end &gt;= start_l) &amp; (seg_start &lt;= end_l)
    if not overlaps.any():
        raise ValueError(&quot;No segments overlap the requested start/end length window.&quot;)

    # -------------------------------------------------------------------------
    # Determine properties to plot
    # -------------------------------------------------------------------------
    special_norm = {lsum_key_norm, vav_key_norm}
    available_props = sorted(set(p for p in lvl0_norm.unique().tolist() if p not in special_norm))

    if properties is None:
        used_properties = available_props
    else:
        used_properties = [norm_prop(p) for p in properties]

    n_props = len(used_properties)
    if n_props == 0:
        raise ValueError(&quot;No properties to plot.&quot;)

    # -------------------------------------------------------------------------
    # Axis labels and limits
    # -------------------------------------------------------------------------
    if axis_labels is None:
        used_axis_labels = [f&quot;{lvl0_name}={p}&quot; for p in used_properties]
    else:
        if len(axis_labels) != n_props:
            raise ValueError(&quot;axis_labels must have same length as properties.&quot;)
        used_axis_labels = list(axis_labels)

    if ylims is not None:
        if len(ylims) != n_props:
            raise ValueError(&quot;ylims must have same length as properties (or be None).&quot;)
        for lim in ylims:
            if lim is not None and (not isinstance(lim, (tuple, list)) or len(lim) != 2):
                raise ValueError(&quot;Each ylims entry must be (ymin, ymax) or None.&quot;)

    # -------------------------------------------------------------------------
    # Tick validation
    # -------------------------------------------------------------------------
    if y_label_ticks is not None:
        if len(y_label_ticks) != n_props:
            raise ValueError(&quot;y_label_ticks must have same length as properties (or be None).&quot;)
        if any((not isinstance(n, int) or n &lt; 2) for n in y_label_ticks):
            raise ValueError(&quot;Each y_label_ticks entry must be an int &gt;= 2.&quot;)

    if y_grid_ticks is not None and (not isinstance(y_grid_ticks, int) or y_grid_ticks &lt; 2):
        raise ValueError(&quot;y_grid_ticks must be an int &gt;= 2 (or None).&quot;)

    if x_label_ticks is not None and (not isinstance(x_label_ticks, int) or x_label_ticks &lt; 2):
        raise ValueError(&quot;x_label_ticks must be an int &gt;= 2 (or None).&quot;)

    if x_grid_ticks is not None and (not isinstance(x_grid_ticks, int) or x_grid_ticks &lt; 2):
        raise ValueError(&quot;x_grid_ticks must be an int &gt;= 2 (or None).&quot;)

    # -------------------------------------------------------------------------
    # Linestyles and colors
    # -------------------------------------------------------------------------
    if linestyles is None:
        linestyles = [&quot;-&quot;, &quot;--&quot;, &quot;:&quot;, &quot;-.&quot;]
    prop_linestyle = {p: linestyles[i % len(linestyles)] for i, p in enumerate(used_properties)}

    colors = plt.rcParams[&quot;axes.prop_cycle&quot;].by_key().get(&quot;color&quot;, [])
    if not colors:
        colors = [&quot;C0&quot;, &quot;C1&quot;, &quot;C2&quot;, &quot;C3&quot;, &quot;C4&quot;, &quot;C5&quot;, &quot;C6&quot;, &quot;C7&quot;, &quot;C8&quot;, &quot;C9&quot;]
    prop_color = {p: colors[i % len(colors)] for i, p in enumerate(used_properties)}

    # -------------------------------------------------------------------------
    # Create figure and stacked left y-axes (unchanged styling)
    # -------------------------------------------------------------------------
    fig, ax0 = plt.subplots(figsize=figsize)
    axes = [ax0]
    for i in range(1, n_props):
        ax = ax0.twinx()
        ax.yaxis.set_label_position(&quot;left&quot;)
        ax.yaxis.tick_left()
        ax.spines[&quot;left&quot;].set_position((&quot;outward&quot;, axis_offset * i))
        ax.spines[&quot;right&quot;].set_visible(False)
        axes.append(ax)

    for ax in axes:
        ax.set_xlim(start_l, end_l)
        ax.margins(x=0)
        ax.autoscale(enable=False, axis=&quot;x&quot;)

    # X ticks
    if x_label_ticks is not None:
        major_xticks = np.linspace(start_l, end_l, x_label_ticks)
        ax0.xaxis.set_major_locator(mticker.FixedLocator(major_xticks))
    else:
        ax0.xaxis.set_major_locator(mticker.AutoLocator())

    if x_grid_ticks is not None:
        minor_xticks = np.linspace(start_l, end_l, x_grid_ticks)
        ax0.xaxis.set_minor_locator(mticker.FixedLocator(minor_xticks))

    if rotate_xticks:
        for lbl in ax0.get_xticklabels():
            lbl.set_rotation(rotate_xticks)
            lbl.set_ha(&quot;right&quot;)

    # -------------------------------------------------------------------------
    # Build property -&gt; sorted sample columns (numeric level1 only)
    # -------------------------------------------------------------------------
    def _sample_index(x: Any) -&gt; int:
        # level1 expected to be int; allow numeric strings
        try:
            return int(x)
        except Exception as e:
            raise ValueError(f&quot;Non-numeric sample index in level1: {x!r}. Expected 0..N.&quot;) from e

    prop_to_sample_cols: dict[str, list[tuple[Any, Any]]] = {}
    for p in used_properties:
        mask_p = (lvl0_norm == p) &amp; ~pd.Index(lvl1_vals).map(_is_minus_one)
        cols = df.columns[mask_p].tolist()
        if cols:
            cols_sorted = sorted(cols, key=lambda c: _sample_index(c[1]))
            prop_to_sample_cols[p] = cols_sorted
        else:
            prop_to_sample_cols[p] = []

    # Direction series
    vav = pd.to_numeric(df[vav_col], errors=&quot;coerce&quot;).to_numpy(dtype=float)

    # -------------------------------------------------------------------------
    # Plot segments
    # -------------------------------------------------------------------------
    all_lines = []
    plotted_any_for_property = {p: False for p in used_properties}
    labeled_property = {p: False for p in used_properties}

    idx = df.index.to_numpy()
    for i, row_idx in enumerate(idx):
        if not overlaps[i]:
            continue

        x0 = float(seg_start[i])
        x1 = float(seg_end[i])
        if x1 &lt;= x0:
            continue

        direction_negative = (vav[i] &lt; 0)

        for prop_idx, prop in enumerate(used_properties):
            ax = axes[prop_idx]
            cols = prop_to_sample_cols.get(prop, [])
            if not cols:
                continue

            vals = df.loc[row_idx, cols]

            notna = vals.notna().to_numpy()
            if not notna.any():
                continue

            last = int(np.where(notna)[0].max())
            vals_upto = vals.iloc[: last + 1].dropna().to_numpy(dtype=float)

            m = len(vals_upto)
            if m &lt; 2:
                # You said this won&#39;t happen; keep safe anyway.
                continue

            if direction_negative:
                vals_upto = vals_upto[::-1]

            x_seg = np.linspace(x0, x1, m)

            label = prop if not labeled_property[prop] else &quot;_nolegend_&quot;
            (ln,) = ax.plot(
                x_seg,
                vals_upto,
                linestyle=prop_linestyle[prop],
                color=prop_color[prop],
                label=label,
            )

            labeled_property[prop] = True
            all_lines.append(ln)
            plotted_any_for_property[prop] = True

            ax.set_ylabel(used_axis_labels[prop_idx])
            if ylims is not None and ylims[prop_idx] is not None:
                ax.set_ylim(*ylims[prop_idx])

    # Missing property handling
    missing_props = [p for p, ok in plotted_any_for_property.items() if not ok]
    if missing_props:
        msg = f&quot;Requested properties produced no plotted lines (missing or all-NaN): {missing_props}&quot;
        if missing == &quot;error&quot;:
            raise ValueError(msg)
        elif missing == &quot;warn&quot;:
            _log_warn(msg)

    # Y ticks and y-grid ticks
    for prop_idx, ax in enumerate(axes):
        if y_label_ticks is not None:
            y0, y1 = ax.get_ylim()
            ax.set_yticks(np.linspace(y0, y1, y_label_ticks[prop_idx]))

    if y_grid_ticks is not None:
        y0, y1 = ax0.get_ylim()
        ax0.yaxis.set_minor_locator(mticker.FixedLocator(np.linspace(y0, y1, y_grid_ticks)))

    # Labels, grid, title, legend
    ax0.set_xlabel(&quot;l_sum&quot;)
    ax0.set_axisbelow(True)

    if grid:
        ax0.grid(True, which=&quot;major&quot;, axis=&quot;both&quot;, linestyle=grid_style, alpha=grid_alpha)
        if x_grid_ticks is not None:
            ax0.grid(True, which=&quot;minor&quot;, axis=&quot;x&quot;, linestyle=grid_style, alpha=grid_alpha)
        if y_grid_ticks is not None:
            ax0.grid(True, which=&quot;minor&quot;, axis=&quot;y&quot;, linestyle=grid_style, alpha=grid_alpha)

    if show_title:
        ax0.set_title(f&quot;{title_prefix}l_sum: {start_l:g} - {end_l:g}&quot;)

    if legend:
        by_label = OrderedDict()
        for ln in all_lines:
            lab = ln.get_label()
            if lab and lab != &quot;_nolegend_&quot; and lab not in by_label:
                by_label[lab] = ln

        handles = list(by_label.values())
        labels = list(by_label.keys())

        if handles:
            if legend_in_figure:
                fig.legend(handles, labels, loc=legend_loc, bbox_to_anchor=legend_coords, fontsize=legend_fontsize)
            else:
                ax0.legend(handles, labels, loc=legend_loc, bbox_to_anchor=legend_coords, fontsize=legend_fontsize)

    fig.tight_layout()
    _log_info(f&quot;Plotted {len(all_lines)} segment-lines for {n_props} properties.&quot;)
    return fig, axes, used_properties
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>s3s.GetResultProperties_from_elementType(s3s.ObjectTypes.Pipe,False)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;A&#39;,
 &#39;ACALC&#39;,
 &#39;CPI&#39;,
 &#39;CPK&#39;,
 &#39;DH&#39;,
 &#39;DP&#39;,
 &#39;DRAGRED&#39;,
 &#39;DRAKONZ&#39;,
 &#39;DSI&#39;,
 &#39;DSK&#39;,
 &#39;DTTR&#39;,
 &#39;DWVERL&#39;,
 &#39;DWVERLABS&#39;,
 &#39;ETAAV&#39;,
 &#39;FS&#39;,
 &#39;HR&#39;,
 &#39;HVEC&#39;,
 &#39;IAKTIV&#39;,
 &#39;IRTRENN&#39;,
 &#39;JV&#39;,
 &#39;JV2&#39;,
 &#39;LAMBDA&#39;,
 &#39;LECKEINAUS&#39;,
 &#39;LECKMENGE&#39;,
 &#39;LECKORT&#39;,
 &#39;LINEPACK&#39;,
 &#39;LINEPACKGEOM&#39;,
 &#39;LINEPACKRATE&#39;,
 &#39;MAINELEMENT&#39;,
 &#39;MAV&#39;,
 &#39;MI&#39;,
 &#39;MK&#39;,
 &#39;MKOND&#39;,
 &#39;MMAX_INST&#39;,
 &#39;MMIN_INST&#39;,
 &#39;MVEC&#39;,
 &#39;MVECMAX_INST&#39;,
 &#39;MVECMIN_INST&#39;,
 &#39;PAV&#39;,
 &#39;PDAMPF&#39;,
 &#39;PHR&#39;,
 &#39;PHVEC&#39;,
 &#39;PMAX&#39;,
 &#39;PMIN&#39;,
 &#39;PR&#39;,
 &#39;PVEC&#39;,
 &#39;PVECMAX_INST&#39;,
 &#39;PVECMIN_INST&#39;,
 &#39;QI2&#39;,
 &#39;QK2&#39;,
 &#39;QMAV&#39;,
 &#39;QMI&#39;,
 &#39;QMK&#39;,
 &#39;QMMAX_INST&#39;,
 &#39;QMMIN_INST&#39;,
 &#39;QMVEC&#39;,
 &#39;QSVB&#39;,
 &#39;RHOAV&#39;,
 &#39;RHOI&#39;,
 &#39;RHOK&#39;,
 &#39;RHOVEC&#39;,
 &#39;SVEC&#39;,
 &#39;TAV&#39;,
 &#39;TI&#39;,
 &#39;TK&#39;,
 &#39;TTRVEC&#39;,
 &#39;TVEC&#39;,
 &#39;TVECMAX_INST&#39;,
 &#39;TVECMIN_INST&#39;,
 &#39;VAV&#39;,
 &#39;VI&#39;,
 &#39;VK&#39;,
 &#39;VMAX_INST&#39;,
 &#39;VMIN_INST&#39;,
 &#39;VOLDA&#39;,
 &#39;WALTERI&#39;,
 &#39;WALTERK&#39;,
 &#39;WVL&#39;,
 &#39;ZAUS&#39;,
 &#39;ZEIN&#39;,
 &#39;ZHKNR&#39;,
 &#39;ZVEC&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_vec.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>tk</th>
      <th>Name</th>
      <th>FkdtroRowd</th>
      <th>Fkltgr</th>
      <th>Fkstrasse</th>
      <th>L</th>
      <th>Lzu</th>
      <th>Rau</th>
      <th>Jlambs</th>
      <th>Lambda0</th>
      <th>Zein</th>
      <th>Zaus</th>
      <th>Zuml</th>
      <th>Asoll</th>
      <th>Indschall</th>
      <th>Baujahr</th>
      <th>Hal</th>
      <th>Fkcont</th>
      <th>Fk2lrohr</th>
      <th>Beschreibung</th>
      <th>Idreferenz</th>
      <th>Iplanung</th>
      <th>Kvr</th>
      <th>LineWidthMM</th>
      <th>DottedLine</th>
      <th>DN</th>
      <th>Di</th>
      <th>KvrKlartext</th>
      <th>HasClosedNSCHs</th>
      <th>Tk</th>
      <th>Pk</th>
      <th>InVariant</th>
      <th>Xkor</th>
      <th>Ykor</th>
      <th>GeometriesDiffer</th>
      <th>bz.Fk</th>
      <th>bz.Qsvb</th>
      <th>bz.Irtrenn</th>
      <th>bz.Leckstatus</th>
      <th>bz.Leckstart</th>
      <th>bz.Leckend</th>
      <th>bz.Leckort</th>
      <th>bz.Leckmenge</th>
      <th>bz.Imptnz</th>
      <th>bz.Zvlimptnz</th>
      <th>bz.Kantenzv</th>
      <th>bz.ITrennWithNSCH</th>
      <th>geometry</th>
      <th>fkKI</th>
      <th>fkKK</th>
      <th>A</th>
      <th>ACALC</th>
      <th>CPI</th>
      <th>CPK</th>
      <th>DH</th>
      <th>DP</th>
      <th>DRAGRED</th>
      <th>DRAKONZ</th>
      <th>DSI</th>
      <th>DSK</th>
      <th>DTTR</th>
      <th>DWVERL</th>
      <th>DWVERLABS</th>
      <th>ETAAV</th>
      <th>FS</th>
      <th>HR</th>
      <th>IAKTIV</th>
      <th>IRTRENN</th>
      <th>JV</th>
      <th>JV2</th>
      <th>LAMBDA</th>
      <th>LECKEINAUS</th>
      <th>LECKMENGE</th>
      <th>LECKORT</th>
      <th>LINEPACK</th>
      <th>LINEPACKGEOM</th>
      <th>LINEPACKRATE</th>
      <th>MAINELEMENT</th>
      <th>MAV</th>
      <th>MI</th>
      <th>MK</th>
      <th>MKOND</th>
      <th>MMAX_INST</th>
      <th>MMIN_INST</th>
      <th colspan="11" halign="left">MVEC</th>
      <th>PAV</th>
      <th>PDAMPF</th>
      <th>PHR</th>
      <th>PMAX</th>
      <th>PMIN</th>
      <th>PR</th>
      <th colspan="11" halign="left">PVEC</th>
      <th colspan="11" halign="left">PVECMAX_INST</th>
      <th colspan="11" halign="left">PVECMIN_INST</th>
      <th>QI2</th>
      <th>QK2</th>
      <th>QMAV</th>
      <th>QMI</th>
      <th>QMK</th>
      <th>QMMAX_INST</th>
      <th>QMMIN_INST</th>
      <th>QSVB</th>
      <th>RHOAV</th>
      <th>RHOI</th>
      <th>RHOK</th>
      <th colspan="11" halign="left">RHOVEC</th>
      <th colspan="11" halign="left">SVEC</th>
      <th>TAV</th>
      <th>TI</th>
      <th>TK</th>
      <th colspan="11" halign="left">TTRVEC</th>
      <th colspan="11" halign="left">TVEC</th>
      <th>VAV</th>
      <th>VI</th>
      <th>VK</th>
      <th>VMAX_INST</th>
      <th>VMIN_INST</th>
      <th>VOLDA</th>
      <th>WALTERI</th>
      <th>WALTERK</th>
      <th>WVL</th>
      <th>ZAUS</th>
      <th>ZEIN</th>
      <th>ZHKNR</th>
      <th colspan="11" halign="left">ZVEC</th>
      <th>l_sum</th>
      <th>AGSN_Lfdnr</th>
      <th>AGSN_Name</th>
    </tr>
    <tr>
      <th>interior points</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>-1</th>
      <th>-1</th>
      <th>-1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5691533564979419761</td>
      <td>Rohr V-E0 V-K1683S</td>
      <td>4816511167455310973</td>
      <td>4779752876656844188</td>
      <td>5204829332281547346</td>
      <td>15.351700</td>
      <td>0</td>
      <td>0.05</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1000</td>
      <td>0</td>
      <td></td>
      <td>0</td>
      <td>5029128874972463118</td>
      <td>5025945677694931826</td>
      <td>OSM: Knoten 476971238 -&gt; Knoten 299394923; Län...</td>
      <td>39785520</td>
      <td>0</td>
      <td>1</td>
      <td>0.005</td>
      <td>0</td>
      <td>350</td>
      <td>345.6</td>
      <td>Vorlauf</td>
      <td></td>
      <td>5691533564979419761</td>
      <td>5691533564979419761</td>
      <td>False</td>
      <td>713619.921383</td>
      <td>5.578219e+06</td>
      <td>False</td>
      <td>5691533564979419761</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>LINESTRING (713619.921 5578218.954, 713614.649...</td>
      <td>5398100694284104779</td>
      <td>4825391580467484032</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.004844</td>
      <td>43.12016</td>
      <td>0.661968</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.152727</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>79.74764</td>
      <td>79.74764</td>
      <td>79.74764</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>0.701074</td>
      <td>0.002345</td>
      <td>99999.0</td>
      <td>5.800678</td>
      <td>99999.0</td>
      <td>5.878785</td>
      <td>5.839730</td>
      <td>5.800680</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.878785</td>
      <td>5.839730</td>
      <td>5.800680</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.878785</td>
      <td>5.839730</td>
      <td>5.800680</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>287.0915</td>
      <td>287.0915</td>
      <td>287.0915</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>965.7</td>
      <td>965.7012</td>
      <td>965.7000</td>
      <td>965.7006</td>
      <td>965.7012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>7.675850</td>
      <td>15.35170</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>89.99999</td>
      <td>89.99802</td>
      <td>0.000000</td>
      <td>0.002422</td>
      <td>0.004844</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>90.00000</td>
      <td>89.99902</td>
      <td>89.99802</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.880315</td>
      <td>0.880315</td>
      <td>0.880314</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>10082.88</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>541.49</td>
      <td>541.89</td>
      <td>542.29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.351701</td>
      <td>1</td>
      <td>Längsschnitt</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5048873293262650113</td>
      <td>Rohr V-K1683S V-K1693S</td>
      <td>4816511167455310973</td>
      <td>4779752876656844188</td>
      <td>5204829332281547346</td>
      <td>12.508950</td>
      <td>0</td>
      <td>0.05</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1000</td>
      <td>0</td>
      <td></td>
      <td>0</td>
      <td>5029128874972463118</td>
      <td>5216742060270992761</td>
      <td>OSM: Knoten 299394923 -&gt; Knoten 4105649557; Lä...</td>
      <td>39785520</td>
      <td>0</td>
      <td>1</td>
      <td>0.005</td>
      <td>0</td>
      <td>350</td>
      <td>345.6</td>
      <td>Vorlauf</td>
      <td></td>
      <td>5048873293262650113</td>
      <td>5048873293262650113</td>
      <td>False</td>
      <td>713614.648712</td>
      <td>5.578233e+06</td>
      <td>False</td>
      <td>5048873293262650113</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>LINESTRING (713614.649 5578233.372, 713614.465...</td>
      <td>4825391580467484032</td>
      <td>5180617780362861593</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.003947</td>
      <td>43.5808</td>
      <td>0.54515</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.152727</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>79.74764</td>
      <td>79.74764</td>
      <td>79.74764</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>0.701027</td>
      <td>0.00191</td>
      <td>99999.0</td>
      <td>5.732475</td>
      <td>99999.0</td>
      <td>5.800680</td>
      <td>5.766575</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.800680</td>
      <td>5.766575</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.800680</td>
      <td>5.766575</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>287.0915</td>
      <td>287.0915</td>
      <td>287.0915</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>965.7012</td>
      <td>965.7021</td>
      <td>965.7012</td>
      <td>965.7017</td>
      <td>965.7021</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>6.254474</td>
      <td>12.50895</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>89.99802</td>
      <td>89.9964</td>
      <td>0.004844</td>
      <td>0.006818</td>
      <td>0.008791</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>89.99802</td>
      <td>89.99722</td>
      <td>89.99640</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.880314</td>
      <td>0.880314</td>
      <td>0.880313</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>10081.81</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>542.29</td>
      <td>542.64</td>
      <td>542.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>27.860648</td>
      <td>1</td>
      <td>Längsschnitt</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5715081934973525403</td>
      <td>Rohr V-K2163S V-K1693S</td>
      <td>4816511167455310973</td>
      <td>4779752876656844188</td>
      <td>5204829332281547346</td>
      <td>6.265505</td>
      <td>0</td>
      <td>0.05</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1000</td>
      <td>0</td>
      <td></td>
      <td>0</td>
      <td>5029128874972463118</td>
      <td>4919359344392474301</td>
      <td>OSM: Knoten 299394922 -&gt; Knoten 4105649557; Lä...</td>
      <td>595926249</td>
      <td>0</td>
      <td>1</td>
      <td>0.005</td>
      <td>0</td>
      <td>350</td>
      <td>345.6</td>
      <td>Vorlauf</td>
      <td></td>
      <td>5715081934973525403</td>
      <td>5715081934973525403</td>
      <td>False</td>
      <td>713614.369043</td>
      <td>5.578252e+06</td>
      <td>False</td>
      <td>5715081934973525403</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>LINESTRING (713614.369 5578252.145, 713614.465...</td>
      <td>4964920487041183545</td>
      <td>5180617780362861593</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.001977</td>
      <td>43.50407</td>
      <td>0.272575</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.152727</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>-79.74764</td>
      <td>-79.74764</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>0.700995</td>
      <td>0.000957</td>
      <td>99999.0</td>
      <td>5.699317</td>
      <td>99999.0</td>
      <td>5.699315</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.699315</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.699315</td>
      <td>5.732475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>-287.0915</td>
      <td>-287.0915</td>
      <td>-287.0915</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>965.7026</td>
      <td>965.7021</td>
      <td>965.7026</td>
      <td>965.7021</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>6.265505</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>99999.0</td>
      <td>89.9956</td>
      <td>89.9964</td>
      <td>0.010768</td>
      <td>0.008791</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>89.99561</td>
      <td>89.99640</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.880313</td>
      <td>-0.880313</td>
      <td>-0.880313</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>0.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>-10080.92</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>99999.0</td>
      <td>543.33</td>
      <td>542.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.126153</td>
      <td>1</td>
      <td>Längsschnitt</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, axes, used = plot_time_curves(
    df=df_vec,

    # NEW: interpreted as length window on l_sum (floats), not timestamps
    start=0.0,
    end=1300,  # &lt;-- set this to the l_sum range you want

    properties=[&quot;PVEC&quot;, &quot;TVEC&quot;],
    axis_labels=[&quot;PH bar&quot;, &quot;H Druck in barBzg&quot;],
    ylims=[(2, 6), (80, 100)],

    # kept for compatibility but not used by the new logic (can be omitted)
    # tks_per_property=...,

    y_label_ticks=[5, 6],
    y_grid_ticks=9,
    x_label_ticks=27,
    x_grid_ticks=14,

    legend=True,
    legend_in_figure=True,
    legend_loc=&quot;upper left&quot;,
    legend_coords=(0.67, 0.33),
    legend_fontsize=15,

    title_prefix=&quot;Testplot: &quot;,
    show_title=True,

    axis_offset=70,
    linestyles=[&quot;-&quot;, &quot;--&quot;, &quot;:&quot;],
    rotate_xticks=0,

    grid=True,
    grid_style=&quot;--&quot;,
    grid_alpha=0.8,

    missing=&quot;warn&quot;,
    logger=None,
)
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_SIR3S_Model_Mantle_ToolkitTutorial072_27_0.png" src="../../_images/tutorials_SIR3S_Model_Mantle_ToolkitTutorial072_27_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>1/0
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ZeroDivisionError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[18], line 1</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> <span style="color: rgb(98,98,98)">1</span><span style="color: rgb(98,98,98)">/</span><span style="color: rgb(98,98,98)">0</span>

<span class="ansi-red-intense-fg ansi-bold">ZeroDivisionError</span>: division by zero
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import pandas as pd
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def plot(dfAGSN=pd.DataFrame()
        ,dfAGSNRL=pd.DataFrame()
        ,PHCol=&#39;(&quot;PVEC&quot;, &quot;0&quot;)&#39;
        ,mlcCol=&#39;mlc_n&#39;
        ,zKoorCol=&#39;ZKOR_n&#39;
        ,barBzgCol=&#39;H_n&#39;
        ,QMCol=&#39;QM&#39;
        ,TCol=&#39;T_n&#39;
        ,xCol=&#39;LSum&#39;

):

    fig, ax0 = plt.subplots(figsize=(20,11.9))

    ax0.set_yticks(np.linspace(0, 10, 21))
    ax0.yaxis.set_ticklabels([])
    ax0.grid()

    #PH
    ax1 = ax0.twinx()
    fyPH(ax1)
    PH_SL=ax1.plot(dfAGSN[xCol], dfAGSN[PHCol], color=&#39;red&#39;, label=&#39;PH SL&#39;,ls=&#39;dotted&#39;)
    PH_RL=ax1.plot(dfAGSNRL[xCol], dfAGSNRL[PHCol], color=&#39;blue&#39;, label=&#39;PH RL&#39;,ls=&#39;dotted&#39;)

    #mlc
    ax11 = ax0.twinx()
    fymlc(ax11)
    mlc_SL=ax11.plot(dfAGSN[xCol], dfAGSN[mlcCol], color=&#39;red&#39;, label=&#39;mlc SL&#39;)
    mlc_RL=ax11.plot(dfAGSNRL[xCol], dfAGSNRL[mlcCol], color=&#39;blue&#39;, label=&#39;mlc RL&#39;)

    z=ax11.plot(dfAGSN[xCol], dfAGSN[zKoorCol], color=&#39;black&#39;, label=&#39;z&#39;,ls=&#39;dashed&#39;,alpha=.5)

    #barBZG
    ax12 = ax0.twinx()
    fybarBzg(ax12)
    barB_SL=ax12.plot(dfAGSN[xCol], dfAGSN[barBzgCol], color=&#39;red&#39;, label=&#39;H SL&#39;,ls=&#39;dashdot&#39;)
    barB_RL=ax12.plot(dfAGSNRL[xCol], dfAGSNRL[barBzgCol], color=&#39;blue&#39;, label=&#39;H RL&#39;,ls=&#39;dashdot&#39;)
    &quot;&quot;&quot;
    #M
    ax2 = ax0.twinx()
    fyM(ax2)
    QM_SL=ax2.step(dfAGSN[xCol], dfAGSN[QMCol]*dfAGSN[&#39;direction&#39;], color=&#39;orange&#39;, label=&#39;M SL&#39;)
    QM_RL=ax2.step(dfAGSNRL[xCol], dfAGSNRL[QMCol]*dfAGSNRL[&#39;direction&#39;], color=&#39;cyan&#39;, label=&#39;M RL&#39;,ls=&#39;--&#39;)

    #T
    ax3 = ax0.twinx()
    fyT(ax3)
    T_SL=ax3.plot(dfAGSN[xCol], dfAGSN[TCol], color=&#39;pink&#39;, label=&#39;T SL&#39;)
    T_RL=ax3.plot(dfAGSNRL[xCol], dfAGSNRL[TCol], color=&#39;lavender&#39;, label=&#39;T RL&#39;)
    &quot;&quot;&quot;
    ax0.set_title(&#39;Longitudinal Section for &#39;)#+dbFilename)

    # added these three lines
    lns =  PH_SL+ PH_RL + mlc_SL+ mlc_RL + barB_SL+ barB_RL#+ QM_SL+ QM_RL + T_SL+ T_RL + z
    labs = [l.get_label() for l in lns]
    ax0.legend(lns, labs)#, loc=0)

    plt.show()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def plot(
    dfAGSN=df_vec,
    xCol=&quot;l_sum&quot;,
    PHCol=(&quot;PVEC&quot;, 0),
    barBzgCol=(&quot;HVEC&quot;, 0)
):
    fig, ax0 = plt.subplots(figsize=(20,11.9))

    ax0.set_yticks(np.linspace(0, 10, 21))
    ax0.yaxis.set_ticklabels([])
    ax0.grid()

    #PH
    ax1 = ax0.twinx()
    fyPH(ax1)
    PH_SL=ax1.plot(dfAGSN[xCol], dfAGSN[PHCol], color=&#39;red&#39;, label=&#39;PH SL&#39;,ls=&#39;dotted&#39;)
    #PH_RL=ax1.plot(dfAGSNRL[xCol], dfAGSNRL[PHCol], color=&#39;blue&#39;, label=&#39;PH RL&#39;,ls=&#39;dotted&#39;)

    #barBZG
    ax12 = ax0.twinx()
    fybarBzg(ax12)
    barB_SL=ax12.plot(dfAGSN[xCol], dfAGSN[barBzgCol], color=&#39;red&#39;, label=&#39;H SL&#39;,ls=&#39;dashdot&#39;)

    ax0.set_title(&#39;Longitudinal Section for &#39;)#+dbFilename)

    # added these three lines
    lns =  PH_SL + barB_SL#+ PH_RL + mlc_SL+ mlc_RL + barB_SL+ barB_RL#+ QM_SL+ QM_RL + T_SL+ T_RL + z
    labs = [l.get_label() for l in lns]
    ax0.legend(lns, labs)#, loc=0)

    plt.show()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot(df_vec)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[23], line 1</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> plot(df_vec)

Cell <span class="ansi-green-intense-fg ansi-bold">In[22], line 9</span>, in <span class="ansi-cyan-fg">plot</span><span class="ansi-blue-intense-fg ansi-bold">(dfAGSN, xCol, PHCol, barBzgCol)</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">plot</span>(
<span class="ansi-green-fg">      2</span>     dfAGSN<span style="color: rgb(98,98,98)">=</span>df_vec,
<span class="ansi-green-fg">      3</span>     xCol<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">l_sum</span><span style="color: rgb(175,0,0)">&#34;</span>,
<span class="ansi-green-fg">      4</span>     PHCol<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">PVEC</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">0</span>),
<span class="ansi-green-fg">      5</span>     barBzgCol<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">HVEC</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(98,98,98)">0</span>)
<span class="ansi-green-fg">      6</span> ):
<span class="ansi-green-fg">      7</span>     fig, ax0 <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">20</span>,<span style="color: rgb(98,98,98)">11.9</span>))
<span class="ansi-green-intense-fg ansi-bold">----&gt; 9</span>     ax0<span style="color: rgb(98,98,98)">.</span>set_yticks(np<span style="color: rgb(98,98,98)">.</span>linspace(<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">10</span>, <span style="color: rgb(98,98,98)">21</span>))
<span class="ansi-green-fg">     10</span>     ax0<span style="color: rgb(98,98,98)">.</span>yaxis<span style="color: rgb(98,98,98)">.</span>set_ticklabels([])
<span class="ansi-green-fg">     11</span>     ax0<span style="color: rgb(98,98,98)">.</span>grid()

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;np&#39; is not defined
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_SIR3S_Model_Mantle_ToolkitTutorial072_33_1.png" src="../../_images/tutorials_SIR3S_Model_Mantle_ToolkitTutorial072_33_1.png" />
</div>
</div>
<p>…</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 3S Consult GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>